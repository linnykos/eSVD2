<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Initialize eSVD — initialize_esvd • eSVD2</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Initialize eSVD — initialize_esvd"><meta name="description" content="For each gene, this function estimates two ridge-regression penalized GLMs (using the
Poisson model) – one using the case_control_variable and one without, and
both sets of coefficients as well as the p-value (according to a deviance test) is returned.
This p-value is on the log10-scale."><meta property="og:description" content="For each gene, this function estimates two ridge-regression penalized GLMs (using the
Poisson model) – one using the case_control_variable and one without, and
both sets of coefficients as well as the p-value (according to a deviance test) is returned.
This p-value is on the log10-scale."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">eSVD2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1.02</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/eSVD2.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/asd-preprocess.html">Neuron preprocessing for eSVD-DE tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/asd.html">Neuron analysis for Layer 2/3 in ASD</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Initialize eSVD</h1>

      <div class="d-none name"><code>initialize_esvd.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>For each gene, this function estimates two ridge-regression penalized GLMs (using the
Poisson model) – one using the <code>case_control_variable</code> and one without, and
both sets of coefficients as well as the p-value (according to a deviance test) is returned.
This p-value is on the log10-scale.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">initialize_esvd</span><span class="op">(</span></span>
<span>  <span class="va">dat</span>,</span>
<span>  <span class="va">covariates</span>,</span>
<span>  <span class="va">metadata_individual</span>,</span>
<span>  bool_intercept <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  case_control_variable <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  k <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  library_size_variable <span class="op">=</span> <span class="st">"Log_UMI"</span>,</span>
<span>  offset_variables <span class="op">=</span> <span class="st">"Log_UMI"</span>,</span>
<span>  metadata_case_control <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dat">dat<a class="anchor" aria-label="anchor" href="#arg-dat"></a></dt>
<dd><p>Dataset (either <code>matrix</code> or <code>dgCMatrix</code>) where the \(n\) rows represent cells
and \(p\) columns represent genes.
The rows and columns of the matrix should be named.</p></dd>


<dt id="arg-covariates">covariates<a class="anchor" aria-label="anchor" href="#arg-covariates"></a></dt>
<dd><p><code>matrix</code> object with \(n\) rows with the same rownames as <code>dat</code> where the columns
represent the different covariates.
Notably, this should contain only numerical columns (i.e., all categorical
variables should have already been split into numerous indicator variables), and all the columns
in <code>covariates</code> will (strictly speaking) be included in the eSVD matrix factorization model.</p></dd>


<dt id="arg-metadata-individual">metadata_individual<a class="anchor" aria-label="anchor" href="#arg-metadata-individual"></a></dt>
<dd><p><code>factor</code> vector of length \(n\) that denotes which cell originates from which individual.</p></dd>


<dt id="arg-bool-intercept">bool_intercept<a class="anchor" aria-label="anchor" href="#arg-bool-intercept"></a></dt>
<dd><p>Boolean on whether or not an intercept will be included as a covariate.</p></dd>


<dt id="arg-case-control-variable">case_control_variable<a class="anchor" aria-label="anchor" href="#arg-case-control-variable"></a></dt>
<dd><p>A string of the column name of <code>covariates</code> which depicts the case-control
status of each cell. Notably, this should be a binary variable where a <code>1</code>
is hard-coded to describe case, and a <code>0</code> to describe control.</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>Number of latent dimensions.</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>Penalty of the <code>mixed_effect_variables</code> when using <code><a href="https://rdrr.io/pkg/glmnet/man/glmnet.html" class="external-link">glmnet::glmnet</a></code> to
initialize the coefficients.</p></dd>


<dt id="arg-library-size-variable">library_size_variable<a class="anchor" aria-label="anchor" href="#arg-library-size-variable"></a></dt>
<dd><p>A string of the variable name (which must be in <code>covariates</code>) of which variable denotes the sequenced (i.e., observed) library size.</p></dd>


<dt id="arg-offset-variables">offset_variables<a class="anchor" aria-label="anchor" href="#arg-offset-variables"></a></dt>
<dd><p>A vector of strings depicting which column names in <code>covariate</code> will
be set to have a coefficient of <code>1</code> automatically (i.e., there will be no estimation
of their coefficient).</p></dd>


<dt id="arg-metadata-case-control">metadata_case_control<a class="anchor" aria-label="anchor" href="#arg-metadata-case-control"></a></dt>
<dd><p>(Optional) vector of length \(n\) with values strictly 0 or 1 that denotes if a cell is from cases or controls.
By default, this is set to <code>NULL</code> since the code will extract this information from <code>covariates</code>.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Integer</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>eSVD</code> object with elements <code>dat</code>, <code>covariates</code>,
<code>initial_Reg</code> and <code>param</code></p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kevin Z Lin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

