[{"path":"https://linnykos.github.io/eSVD2/articles/asd-preprocess.html","id":"downloading-the-data","dir":"Articles","previous_headings":"","what":"Downloading the data","title":"Neuron preprocessing for eSVD-DE tutorial","text":"data working can downloaded https://cells.ucsc.edu/autism/rawMatrix.zip. downloading , get file called rawMatrix.zip, , unzipping, contains barcodes.tsv: matrix 104,559 rows (.e., cells) 1 column, denoting cells’ barcodes genes.tsv: matrix 65,217 rows (.e., genes) 2 columns, denoting ENSEMBL ID Gene Symbols matrix.mtx: sparse matrix 65,217 rows 104,559 columns, denoting counts cell-gene pair meta.txt: matrix 104,559 rows (.e., cells) 16 columns, containing various covariates cell/donor original paper https://pubmed.ncbi.nlm.nih.gov/31097668/.","code":""},{"path":"https://linnykos.github.io/eSVD2/articles/asd-preprocess.html","id":"setting-up-in-r","dir":"Articles","previous_headings":"","what":"Setting up in R","title":"Neuron preprocessing for eSVD-DE tutorial","text":"following packages. sparseMatrixStats Bioconductor.","code":"library(Matrix) library(Seurat) library(sparseMatrixStats)  set.seed(10) date_of_run <- Sys.time() session_info <- devtools::session_info()"},{"path":"https://linnykos.github.io/eSVD2/articles/asd-preprocess.html","id":"reading-in-the-data","dir":"Articles","previous_headings":"","what":"Reading in the data","title":"Neuron preprocessing for eSVD-DE tutorial","text":"First, read data. simplicity vignette’s preprocessing, since duplicated genes, arbitrarily remove duplicates.","code":"mat <- Matrix::readMM(\"/Users/kevinlin/Downloads/rawMatrix/matrix.mtx\") gene_mat <- read.csv(\"/Users/kevinlin/Downloads/rawMatrix/genes.tsv\", sep = \"\\t\", header = F) cell_mat <- read.csv(\"/Users/kevinlin/Downloads/rawMatrix/barcodes.tsv\", sep = \"\\t\", header = F) metadata <- read.csv(\"/Users/kevinlin/Downloads/rawMatrix/meta.txt\", sep = \"\\t\", header = T, stringsAsFactors = TRUE) metadata$individual <- factor(paste0(\"indiv_\", metadata$individual))  rownames(mat) <- gene_mat[,2] colnames(mat) <- cell_mat[,1]  # remove duplicates if(any(duplicated(rownames(mat)))){   mat <- mat[-which(duplicated(rownames(mat))),] }  rownames(metadata) <- metadata$cell metadata <- metadata[,setdiff(colnames(metadata), \"cell\")]"},{"path":"https://linnykos.github.io/eSVD2/articles/asd-preprocess.html","id":"creating-seurat-object","dir":"Articles","previous_headings":"","what":"Creating Seurat object","title":"Neuron preprocessing for eSVD-DE tutorial","text":"Next, create Seurat object filter cells Layer 2/3. (abbreviate Seurat object “asd” “Autism Spectrum Disorder”.)","code":"asd <- Seurat::CreateSeuratObject(counts = mat,                                   meta.data = metadata)  asd <- subset(asd, cluster == \"L2/3\")  asd[[\"percent.mt\"]] <- Seurat::PercentageFeatureSet(asd, pattern = \"^MT-\")"},{"path":"https://linnykos.github.io/eSVD2/articles/asd-preprocess.html","id":"preprocessing-the-seurat-object","dir":"Articles","previous_headings":"","what":"Preprocessing the Seurat object","title":"Neuron preprocessing for eSVD-DE tutorial","text":"basic preprocessing. Mainly, consists first remove genes counts , removing cells many counts, removing genes many counts. , aggregate genes deemed highly variable, original DEGs found Velmeshev et al. paper, housekeeping genes, SFARI genes. union genes ones set “highly variable,” like eSVD-DE analysis later use genes. done step, ready perform eSVD-DE analysis (vignette). done, can save minimal Seurat object eSVD-DE vignette. file roughly 97 Mb size.","code":"set.seed(10) mat <- SeuratObject::LayerData(asd, layer = \"counts\", assay = \"RNA\") mat <- Matrix::t(mat)  # remove genes with all 0's gene_sum <- Matrix::colSums(mat) if (any(gene_sum == 0)) {   features <- SeuratObject::Features(asd)   features <- setdiff(features, names(gene_sum)[which(gene_sum == 0)])   asd <- subset(asd, features = features) }  # remove cells with too high counts keep_vec <- rep(TRUE, length(Seurat::Cells(asd))) keep_vec[asd$nCount_RNA >= 60000] <- FALSE asd[[\"keep\"]] <- keep_vec asd <- subset(asd, keep == TRUE)  # remove genes with too high counts mat <- SeuratObject::LayerData(asd, layer = \"counts\", assay = \"RNA\") mat <- Matrix::t(mat) gene_total <- Matrix::colSums(log1p(mat)) gene_threshold <- log1p(10) * nrow(mat) features <- colnames(mat)[which(gene_total <= gene_threshold)] asd <- subset(asd, features = features)  # find the variable genes asd <- Seurat::NormalizeData(asd) asd <- Seurat::FindVariableFeatures(asd, selection.method = \"vst\", nfeatures = 5000)  data(\"velmeshev_gene_df\", package = \"eSVD2\") de_genes <- velmeshev_gene_df[velmeshev_gene_df[, \"Cell type\"] == \"L2/3\", \"Gene name\"]  data(\"housekeeping_df\", package = \"eSVD2\") hk_genes <- housekeeping_df[, \"Gene\"]  data(\"sfari_df\", package = \"eSVD2\") sfari_genes <- sfari_df[, \"gene.symbol\"]  gene_keep <- unique(c(   de_genes,   hk_genes,   sfari_genes,   Seurat::VariableFeatures(asd) )) rm_idx <- grep(\"^MT\", gene_keep) # remove mitochondrial genes if(length(rm_idx) > 0) gene_keep <- gene_keep[-rm_idx] gene_current <- SeuratObject::Features(asd) gene_keep <- intersect(gene_current, gene_keep) Seurat::VariableFeatures(asd) <- gene_keep asd <- subset(asd, features = Seurat::VariableFeatures(asd)) save(asd, date_of_run, session_info, file = \"asd_seurat.RData\")"},{"path":"https://linnykos.github.io/eSVD2/articles/asd-preprocess.html","id":"visualizing-the-data","dir":"Articles","previous_headings":"","what":"Visualizing the data","title":"Neuron preprocessing for eSVD-DE tutorial","text":"nice visualize dataset analysis, eSVD-DE different. Hence, can simple preprocessing. UMAP L2/3 neurons","code":"set.seed(10) asd <- Seurat::ScaleData(asd, features = Seurat::VariableFeatures(asd)) asd <- Seurat::RunPCA(asd,                       features = Seurat::VariableFeatures(object = asd),                       verbose = FALSE)  set.seed(10) asd <- Seurat::RunUMAP(asd, dims = 1:30) p1 <- Seurat::DimPlot(   asd,   reduction = 'umap',   group.by = 'diagnosis',   label = TRUE,   repel = TRUE,   label.size = 2.5 ) + Seurat::NoLegend() p2 <- Seurat::DimPlot(   asd,   reduction = 'umap',   group.by = 'individual',   label = TRUE,   repel = TRUE,   label.size = 2.5 ) + Seurat::NoLegend() p1 + p2"},{"path":"https://linnykos.github.io/eSVD2/articles/asd-preprocess.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Neuron preprocessing for eSVD-DE tutorial","text":"following shows suggested package versions developer (GitHub username: linnykos) used developing eSVD2 package.","code":"devtools::session_info() ## ─ Session info ─────────────────────────────────────────────────────────────── ##  setting  value ##  version  R version 4.4.1 (2024-06-14) ##  os       Ubuntu 22.04.4 LTS ##  system   x86_64, linux-gnu ##  ui       X11 ##  language en ##  collate  C.UTF-8 ##  ctype    C.UTF-8 ##  tz       UTC ##  date     2024-07-13 ##  pandoc   3.1.11 @ /opt/hostedtoolcache/pandoc/3.1.11/x64/ (via rmarkdown) ##  ## ─ Packages ─────────────────────────────────────────────────────────────────── ##  package           * version  date (UTC) lib source ##  abind               1.4-5    2016-07-21 [1] RSPM ##  bslib               0.7.0    2024-03-29 [1] RSPM ##  cachem              1.1.0    2024-05-16 [1] RSPM ##  cli                 3.6.3    2024-06-21 [1] RSPM ##  cluster             2.1.6    2023-12-01 [3] CRAN (R 4.4.1) ##  codetools           0.2-20   2024-03-31 [3] CRAN (R 4.4.1) ##  colorspace          2.1-0    2023-01-23 [1] RSPM ##  cowplot             1.1.3    2024-01-22 [1] RSPM ##  data.table          1.15.4   2024-03-30 [1] RSPM ##  deldir              2.0-4    2024-02-28 [1] RSPM ##  desc                1.4.3    2023-12-10 [1] RSPM ##  devtools            2.4.5    2022-10-11 [1] RSPM ##  digest              0.6.36   2024-06-23 [1] RSPM ##  dotCall64           1.1-1    2023-11-28 [1] RSPM ##  dplyr               1.1.4    2023-11-17 [1] RSPM ##  ellipsis            0.3.2    2021-04-29 [1] RSPM ##  evaluate            0.24.0   2024-06-10 [1] RSPM ##  fansi               1.0.6    2023-12-08 [1] RSPM ##  fastDummies         1.7.3    2023-07-06 [1] RSPM ##  fastmap             1.2.0    2024-05-15 [1] RSPM ##  fitdistrplus        1.2-1    2024-07-12 [1] RSPM ##  fs                  1.6.4    2024-04-25 [1] RSPM ##  future              1.33.2   2024-03-26 [1] RSPM ##  future.apply        1.11.2   2024-03-28 [1] RSPM ##  generics            0.1.3    2022-07-05 [1] RSPM ##  ggplot2             3.5.1    2024-04-23 [1] RSPM ##  ggrepel             0.9.5    2024-01-10 [1] RSPM ##  ggridges            0.5.6    2024-01-23 [1] RSPM ##  globals             0.16.3   2024-03-08 [1] RSPM ##  glue                1.7.0    2024-01-09 [1] RSPM ##  goftest             1.2-3    2021-10-07 [1] RSPM ##  gridExtra           2.3      2017-09-09 [1] RSPM ##  gtable              0.3.5    2024-04-22 [1] RSPM ##  highr               0.11     2024-05-26 [1] RSPM ##  htmltools           0.5.8.1  2024-04-04 [1] RSPM ##  htmlwidgets         1.6.4    2023-12-06 [1] RSPM ##  httpuv              1.6.15   2024-03-26 [1] RSPM ##  httr                1.4.7    2023-08-15 [1] RSPM ##  ica                 1.0-3    2022-07-08 [1] RSPM ##  igraph              2.0.3    2024-03-13 [1] RSPM ##  irlba               2.3.5.1  2022-10-03 [1] RSPM ##  jquerylib           0.1.4    2021-04-26 [1] RSPM ##  jsonlite            1.8.8    2023-12-04 [1] RSPM ##  KernSmooth          2.23-24  2024-05-17 [3] CRAN (R 4.4.1) ##  knitr               1.48     2024-07-07 [1] RSPM ##  later               1.3.2    2023-12-06 [1] RSPM ##  lattice             0.22-6   2024-03-20 [3] CRAN (R 4.4.1) ##  lazyeval            0.2.2    2019-03-15 [1] RSPM ##  leiden              0.4.3.1  2023-11-17 [1] RSPM ##  lifecycle           1.0.4    2023-11-07 [1] RSPM ##  listenv             0.9.1    2024-01-29 [1] RSPM ##  lmtest              0.9-40   2022-03-21 [1] RSPM ##  magrittr            2.0.3    2022-03-30 [1] RSPM ##  MASS                7.3-60.2 2024-04-26 [3] CRAN (R 4.4.1) ##  Matrix            * 1.7-0    2024-04-26 [3] CRAN (R 4.4.1) ##  MatrixGenerics    * 1.16.0   2024-04-30 [1] Bioconduc~ ##  matrixStats       * 1.3.0    2024-04-11 [1] RSPM ##  memoise             2.0.1    2021-11-26 [1] RSPM ##  mime                0.12     2021-09-28 [1] RSPM ##  miniUI              0.1.1.1  2018-05-18 [1] RSPM ##  munsell             0.5.1    2024-04-01 [1] RSPM ##  nlme                3.1-164  2023-11-27 [3] CRAN (R 4.4.1) ##  parallelly          1.37.1   2024-02-29 [1] RSPM ##  patchwork           1.2.0    2024-01-08 [1] RSPM ##  pbapply             1.7-2    2023-06-27 [1] RSPM ##  pillar              1.9.0    2023-03-22 [1] RSPM ##  pkgbuild            1.4.4    2024-03-17 [1] RSPM ##  pkgconfig           2.0.3    2019-09-22 [1] RSPM ##  pkgdown             2.1.0    2024-07-06 [1] RSPM ##  pkgload             1.4.0    2024-06-28 [1] RSPM ##  plotly              4.10.4   2024-01-13 [1] RSPM ##  plyr                1.8.9    2023-10-02 [1] RSPM ##  png                 0.1-8    2022-11-29 [1] RSPM ##  polyclip            1.10-6   2023-09-27 [1] RSPM ##  profvis             0.3.8    2023-05-02 [1] RSPM ##  progressr           0.14.0   2023-08-10 [1] RSPM ##  promises            1.3.0    2024-04-05 [1] RSPM ##  purrr               1.0.2    2023-08-10 [1] RSPM ##  R6                  2.5.1    2021-08-19 [1] RSPM ##  ragg                1.3.2    2024-05-15 [1] RSPM ##  RANN                2.6.1    2019-01-08 [1] RSPM ##  RColorBrewer        1.1-3    2022-04-03 [1] RSPM ##  Rcpp                1.0.12   2024-01-09 [1] RSPM ##  RcppAnnoy           0.0.22   2024-01-23 [1] RSPM ##  RcppHNSW            0.6.0    2024-02-04 [1] RSPM ##  remotes             2.5.0    2024-03-17 [1] RSPM ##  reshape2            1.4.4    2020-04-09 [1] RSPM ##  reticulate          1.38.0   2024-06-19 [1] RSPM ##  rlang               1.1.4    2024-06-04 [1] RSPM ##  rmarkdown           2.27     2024-05-17 [1] RSPM ##  ROCR                1.0-11   2020-05-02 [1] RSPM ##  RSpectra            0.16-1   2022-04-24 [1] RSPM ##  Rtsne               0.17     2023-12-07 [1] RSPM ##  sass                0.4.9    2024-03-15 [1] RSPM ##  scales              1.3.0    2023-11-28 [1] RSPM ##  scattermore         1.2      2023-06-12 [1] RSPM ##  sctransform         0.4.1    2023-10-19 [1] RSPM ##  sessioninfo         1.2.2    2021-12-06 [1] RSPM ##  Seurat            * 5.1.0    2024-05-10 [1] RSPM ##  SeuratObject      * 5.0.2    2024-05-08 [1] RSPM ##  shiny               1.8.1.1  2024-04-02 [1] RSPM ##  sp                * 2.1-4    2024-04-30 [1] RSPM ##  spam                2.10-0   2023-10-23 [1] RSPM ##  sparseMatrixStats * 1.16.0   2024-04-30 [1] Bioconduc~ ##  spatstat.data       3.1-2    2024-06-21 [1] RSPM ##  spatstat.explore    3.2-7    2024-03-21 [1] RSPM ##  spatstat.geom       3.2-9    2024-02-28 [1] RSPM ##  spatstat.random     3.2-3    2024-02-29 [1] RSPM ##  spatstat.sparse     3.1-0    2024-06-21 [1] RSPM ##  spatstat.utils      3.0-5    2024-06-17 [1] RSPM ##  stringi             1.8.4    2024-05-06 [1] RSPM ##  stringr             1.5.1    2023-11-14 [1] RSPM ##  survival            3.6-4    2024-04-24 [3] CRAN (R 4.4.1) ##  systemfonts         1.1.0    2024-05-15 [1] RSPM ##  tensor              1.5      2012-05-05 [1] RSPM ##  textshaping         0.4.0    2024-05-24 [1] RSPM ##  tibble              3.2.1    2023-03-20 [1] RSPM ##  tidyr               1.3.1    2024-01-24 [1] RSPM ##  tidyselect          1.2.1    2024-03-11 [1] RSPM ##  urlchecker          1.0.1    2021-11-30 [1] RSPM ##  usethis             2.2.3    2024-02-19 [1] RSPM ##  utf8                1.2.4    2023-10-22 [1] RSPM ##  uwot                0.2.2    2024-04-21 [1] RSPM ##  vctrs               0.6.5    2023-12-01 [1] RSPM ##  viridisLite         0.4.2    2023-05-02 [1] RSPM ##  xfun                0.45     2024-06-16 [1] RSPM ##  xtable              1.8-4    2019-04-21 [1] RSPM ##  yaml                2.3.9    2024-07-05 [1] RSPM ##  zoo                 1.8-12   2023-04-13 [1] RSPM ##  ##  [1] /home/runner/work/_temp/Library ##  [2] /opt/R/4.4.1/lib/R/site-library ##  [3] /opt/R/4.4.1/lib/R/library ##  ## ──────────────────────────────────────────────────────────────────────────────"},{"path":"https://linnykos.github.io/eSVD2/articles/asd.html","id":"loading-the-data","dir":"Articles","previous_headings":"","what":"Loading the data","title":"Neuron analysis for Layer 2/3 in ASD","text":"first load data. can use table() function roughly see many cells donor contributes many donors classified ASD Control.","code":"load(\"asd_seurat.RData\") asd table(asd$individual, asd$diagnosis) An object of class Seurat  6599 features across 13302 samples within 1 assay  Active assay: RNA (6599 features, 6599 variable features)  2 layers present: counts, data ASD Control indiv_1823    0      72 indiv_4341    0     733 indiv_4849  428       0 indiv_4899  349       0 indiv_5144  202       0 indiv_5163    0     145 indiv_5242    0      81 indiv_5278  944       0 indiv_5294  449       0 indiv_5387    0    1129 indiv_5391    0     237 indiv_5403   69       0 indiv_5408    0     162 indiv_5419  327       0 indiv_5531  631       0 indiv_5538    0     391 indiv_5554    0     233 indiv_5565  881       0 indiv_5577    0     215 indiv_5841  451       0 indiv_5864  275       0 indiv_5879    0     278 indiv_5893    0     976 indiv_5936    0     193 indiv_5939 1016       0 indiv_5945  422       0 indiv_5958    0     826 indiv_5976    0     106 indiv_5978  264       0 indiv_6032    0     289 indiv_6033  528       0"},{"path":"https://linnykos.github.io/eSVD2/articles/asd.html","id":"using-esvd-de","dir":"Articles","previous_headings":"","what":"Using eSVD-DE","title":"Neuron analysis for Layer 2/3 in ASD","text":"testing differential expression mean 15 donors ASD 16 control donors, among 6599 genes. Step 0 (Formatting covariates): use eSVD-DE, want reformat covariates. Typically, good idea set categorical covariates factor variables last level smallest size. last level one get indicator column one-hot encoding using eSVD2::format_covariates(). Step 1 (Initializing eSVD object): First, initialize object class eSVD, call eSVD_obj. done using eSVD2::initialize_esvd() function. following operations use eSVD_obj calculations usage method. pass main inputs dat, covariates, metadata_individual. Notice eSVD2::initialize_esvd() (later, eSVD2::opt_esvd()) always call eSVD2::reparameterization_esvd_covariates() ensure fit remains identifiable. Empirically, found useful set omitted_variables Log_UMI batch variables. means eSVD2 reparameterizes variables, fiddle coefficient Log_UMI. found beneficial since coefficient specifically covariate Log_UMI bears special meaning (impacts normalization sequencing depth directly), wish “mix” covariates correlated Log_UMI early. also found useful keep batch variables separate since datasets analyzed donor covariates correlated batch variable, keeping two aspects (.e., biological effect donor covariates, artifical effect sequencing batches) seperate beneficial. (Overall, strict recommendation, however, found practice beneficial almost instances used eSVD2, tried deviating convention.) single core 2023 Macbook Pro (Apple M2 Max, 32 Gb RAM), took roughly 7 minutes. Step 2 (Fitting eSVD object): now fit eSVD. Typically, recommend fitting twice (.e., calling eSVD2::opt_esvd() twice) due non-convex nature objective function. first call eSVD2::opt_esvd(), hold coefficients covariates aside case-control covariate (, denoted \"CC\" remove much case-control covariate effect possible. , second call eSVD2::opt_esvd(), allow coefficients optimized. Note last fit eSVD2::opt_esvd(), set omitted_variables. typical recommendation – good allow coefficients reparameterized right optimization done. single core 2023 Macbook Pro (Apple M2 Max, 32 Gb RAM), vignette’s dataset, first fit (.e., call eSVD2::opt_esvd()) took roughly 7 minutes (11 iterations). second fit took roughly 4 minutes (15 iterations). Step 3 (Estimating nuisance (.e., -dispersion) parameters): fitting eSVD, need estimate nuisance parameters. Since modeling data via negative binomial, nuisance parameter -dispersion parameter. done via eSVD2::estimate_nuisance() function. single core 2023 Macbook Pro (Apple M2 Max, 32 Gb RAM), took roughly 9 minutes. Step 4 (Computing posterior): -disperison parameter estimated, now ready compute posterior mean variance cell’s gene expression value. posterior distribution balance fitted eSVD denoised value covariate-adjusted library size. step ensures even though pooled genes denoise single-cell expression matrix, later inflate Type-1 error. done via eSVD2::compute_posterior() function. Step 5 (Computing test statistics): Now can compute test statistics using eSVD2::compute_test_statistic() function. Step 6 (Computing p-values): Lastly, can compute p-values via eSVD2::compute_pvalue() function.","code":"gene_vec <- Seurat::VariableFeatures(asd[[\"RNA\"]]) mat <- SeuratObject::LayerData(asd,                                layer = \"counts\",                                assay = \"RNA\",                                features = gene_vec) mat <- Matrix::t(mat) covariate_df <- asd@meta.data[, c(\"individual\",                                   \"region\",                                   \"age\",                                   \"sex\",                                   \"diagnosis\",                                   \"Seqbatch\",                                   \"Capbatch\")]  factor_variables <- c(\"region\", \"diagnosis\", \"sex\", \"Seqbatch\", \"Capbatch\") for (variable in factor_variables) {   covariate_df[, variable] <- factor(covariate_df[, variable], levels = names(sort(table(covariate_df[, variable]), decreasing = T))) }  covariate_df[, \"diagnosis\"] <- factor(covariate_df[, \"diagnosis\"], levels = c(\"Control\", \"ASD\"))  covariates <- eSVD2::format_covariates(   dat = mat,   covariate_df = covariate_df,   rescale_numeric_variables = \"age\" ) time_start1 <- Sys.time() eSVD_obj <- eSVD2::initialize_esvd(   dat = mat,   covariates = covariates[, -grep(\"individual\", colnames(covariates))],   metadata_individual = covariate_df[, \"individual\"],   case_control_variable = \"diagnosis_ASD\",   bool_intercept = TRUE,   k = 30,   lambda = 0.1,   metadata_case_control = covariates[, \"diagnosis_ASD\"],   verbose = 1 ) time_end1 <- Sys.time()  omitted_variables <- colnames(eSVD_obj$covariates)[c(grep(\"Seqbatch\", colnames(eSVD_obj$covariates)), grep(\"Capbatch\", colnames(eSVD_obj$covariates)))] eSVD_obj <- eSVD2::reparameterization_esvd_covariates(   input_obj = eSVD_obj,   fit_name = \"fit_Init\",   omitted_variables = c(\"Log_UMI\", omitted_variables) ) time_start2 <- Sys.time() eSVD_obj <- eSVD2::opt_esvd(   input_obj = eSVD_obj,   l2pen = 0.1,   max_iter = 100,   offset_variables = setdiff(colnames(eSVD_obj$covariates), \"diagnosis_ASD\"),   tol = 1e-6,   verbose = 1,   fit_name = \"fit_First\",   fit_previous = \"fit_Init\" ) time_end2 <- Sys.time() eSVD_obj <- eSVD2::reparameterization_esvd_covariates(   input_obj = eSVD_obj,   fit_name = \"fit_First\",   omitted_variables = c(\"Log_UMI\", omitted_variables) )  time_start3 <- Sys.time() eSVD_obj <- eSVD2::opt_esvd(   input_obj = eSVD_obj,   l2pen = 0.1,   max_iter = 100,   offset_variables = NULL,   tol = 1e-6,   verbose = 1,   fit_name = \"fit_Second\",   fit_previous = \"fit_First\" ) time_end3 <- Sys.time() eSVD_obj <- eSVD2::reparameterization_esvd_covariates(   input_obj = eSVD_obj,   fit_name = \"fit_Second\",   omitted_variables = omitted_variables ) time_start4 <- Sys.time() eSVD_obj <- eSVD2::estimate_nuisance(   input_obj = eSVD_obj,   bool_covariates_as_library = TRUE,   bool_library_includes_interept = TRUE,   bool_use_log = FALSE,   verbose = 1 ) time_end4 <- Sys.time() eSVD_obj <- eSVD2::compute_posterior(   input_obj = eSVD_obj,   bool_adjust_covariates = FALSE,   alpha_max = 2 * max(mat@x),   bool_covariates_as_library = TRUE,   bool_stabilize_underdispersion = TRUE,   library_min = 0.1,   pseudocount = 0 ) eSVD_obj <- eSVD2::compute_test_statistic(input_obj = eSVD_obj, verbose = 1) eSVD_obj <- eSVD2::compute_pvalue(input_obj = eSVD_obj)  save(eSVD_obj, session_info, date_of_run,      file = \"asd_esvd.RData\")"},{"path":"https://linnykos.github.io/eSVD2/articles/asd.html","id":"plotting-the-p-values","dir":"Articles","previous_headings":"","what":"Plotting the p-values","title":"Neuron analysis for Layer 2/3 in ASD","text":"visualize p-values, can plot volcano plot x-axis estimated log fold change (based global case donor mean, donor’s specific mean first computed, minus global control donor mean) y-axis negative log 10 p-value. dotted horizontal line denotes FDR cutoff. give volcano plot biological interpretation, show genes found Gandal et al. (see https://www.nature.com/articles/s41586-022-05377-7) volcano plot well. study based bulk sequencing brain regions, possibly many cell types involved DEG analysis. Nonetheless, expect good number DEGs Gandal et al. highly significant analysis, volcano plot shows. Volcano plot eSVD-DE analysis, highlighting Gandal et al. genes Alternatively, can make volcano plot specifically highlights housekeeping genes, can act rough “negative control”. , expect many housekeeping genes significantly different case control donors. see volcano plot. Volcano plot eSVD-DE analysis, highlighting housekeeping genes","code":"pvalue_vec <- 10 ^ (-eSVD_obj$pvalue_list$log10pvalue) tmp_df <- data.frame(   gene = names(eSVD_obj$pvalue_list$log10pvalue),   lfc = log2(eSVD_obj$case_mean) - log2(eSVD_obj$control_mean),   pvalue = pvalue_vec ) pCutoff <- max(pvalue_vec[which(eSVD_obj$pvalue_list$fdr_vec <= 0.05)])  data(\"gandal_df\", package = \"eSVD2\") gandal_genes <- gandal_df[which(gandal_df[, \"WholeCortex_ASD_FDR\"] <= 0.05), \"external_gene_name\"] gandal_genes <- intersect(gandal_genes, tmp_df$gene)  tmp_df2 <- tmp_df[c(which(!tmp_df$gene %in% gandal_genes),                     which(tmp_df$gene %in% gandal_genes)), ]  colCustom <- sapply(tmp_df2$gene, function(gene) {   ifelse(gene %in% gandal_genes, \"coral\", \"navy\") }) names(colCustom)[colCustom == \"coral\"] <- \"Gandal et al.\" names(colCustom)[colCustom == \"navy\"] <- \"others\"  # png( #   \"volcano.png\", #   width = 1500, #   height = 2000, #   res = 300, #   units = \"px\" # ) EnhancedVolcano::EnhancedVolcano(   tmp_df2,   lab = tmp_df2$gene,   selectLab = gandal_genes,   colCustom = colCustom,   x = \"lfc\",   y = \"pvalue\",   ylim = c(0, max(eSVD_obj$pvalue_list$log10pvalue)),   labSize = 3,   pCutoff = pCutoff,   FCcutoff = 0,   drawConnectors = TRUE ) # graphics.off() data(\"housekeeping_df\", package = \"eSVD2\") hk_genes <- housekeeping_df[, \"Gene\"] hk_genes <- intersect(hk_genes, tmp_df$gene)  tmp_df2 <- tmp_df[c(which(!tmp_df$gene %in% hk_genes),                     which(tmp_df$gene %in% hk_genes)), ]  colCustom <- sapply(tmp_df2$gene, function(gene) {   ifelse(gene %in% hk_genes, \"darkolivegreen1\", \"navy\") }) names(colCustom)[colCustom == \"darkolivegreen1\"] <- \"Housekeeping genes\" names(colCustom)[colCustom == \"navy\"] <- \"others\"  # png( #   \"volcano_hk.png\", #   width = 1500, #   height = 2000, #   res = 300, #   units = \"px\" # ) EnhancedVolcano::EnhancedVolcano(   tmp_df2,   lab = tmp_df2$gene,   selectLab = hk_genes,   colCustom = colCustom,   x = \"lfc\",   y = \"pvalue\",   ylim = c(0, max(eSVD_obj$pvalue_list$log10pvalue)),   labSize = 3,   pCutoff = pCutoff,   FCcutoff = 0,   drawConnectors = TRUE ) # graphics.off()"},{"path":"https://linnykos.github.io/eSVD2/articles/asd.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Neuron analysis for Layer 2/3 in ASD","text":"following shows suggested package versions developer (GitHub username: linnykos) used developing eSVD2 package.","code":"devtools::session_info() ## ─ Session info ─────────────────────────────────────────────────────────────── ##  setting  value ##  version  R version 4.4.1 (2024-06-14) ##  os       Ubuntu 22.04.4 LTS ##  system   x86_64, linux-gnu ##  ui       X11 ##  language en ##  collate  C.UTF-8 ##  ctype    C.UTF-8 ##  tz       UTC ##  date     2024-07-13 ##  pandoc   3.1.11 @ /opt/hostedtoolcache/pandoc/3.1.11/x64/ (via rmarkdown) ##  ## ─ Packages ─────────────────────────────────────────────────────────────────── ##  package          * version  date (UTC) lib source ##  abind              1.4-5    2016-07-21 [1] RSPM ##  bslib              0.7.0    2024-03-29 [1] RSPM ##  cachem             1.1.0    2024-05-16 [1] RSPM ##  cli                3.6.3    2024-06-21 [1] RSPM ##  cluster            2.1.6    2023-12-01 [3] CRAN (R 4.4.1) ##  codetools          0.2-20   2024-03-31 [3] CRAN (R 4.4.1) ##  colorspace         2.1-0    2023-01-23 [1] RSPM ##  cowplot            1.1.3    2024-01-22 [1] RSPM ##  data.table         1.15.4   2024-03-30 [1] RSPM ##  deldir             2.0-4    2024-02-28 [1] RSPM ##  desc               1.4.3    2023-12-10 [1] RSPM ##  devtools           2.4.5    2022-10-11 [1] RSPM ##  digest             0.6.36   2024-06-23 [1] RSPM ##  dotCall64          1.1-1    2023-11-28 [1] RSPM ##  dplyr              1.1.4    2023-11-17 [1] RSPM ##  ellipsis           0.3.2    2021-04-29 [1] RSPM ##  EnhancedVolcano  * 1.22.0   2024-04-30 [1] Bioconduc~ ##  evaluate           0.24.0   2024-06-10 [1] RSPM ##  fansi              1.0.6    2023-12-08 [1] RSPM ##  fastDummies        1.7.3    2023-07-06 [1] RSPM ##  fastmap            1.2.0    2024-05-15 [1] RSPM ##  fitdistrplus       1.2-1    2024-07-12 [1] RSPM ##  fs                 1.6.4    2024-04-25 [1] RSPM ##  future             1.33.2   2024-03-26 [1] RSPM ##  future.apply       1.11.2   2024-03-28 [1] RSPM ##  generics           0.1.3    2022-07-05 [1] RSPM ##  ggplot2          * 3.5.1    2024-04-23 [1] RSPM ##  ggrepel          * 0.9.5    2024-01-10 [1] RSPM ##  ggridges           0.5.6    2024-01-23 [1] RSPM ##  globals            0.16.3   2024-03-08 [1] RSPM ##  glue               1.7.0    2024-01-09 [1] RSPM ##  goftest            1.2-3    2021-10-07 [1] RSPM ##  gridExtra          2.3      2017-09-09 [1] RSPM ##  gtable             0.3.5    2024-04-22 [1] RSPM ##  highr              0.11     2024-05-26 [1] RSPM ##  htmltools          0.5.8.1  2024-04-04 [1] RSPM ##  htmlwidgets        1.6.4    2023-12-06 [1] RSPM ##  httpuv             1.6.15   2024-03-26 [1] RSPM ##  httr               1.4.7    2023-08-15 [1] RSPM ##  ica                1.0-3    2022-07-08 [1] RSPM ##  igraph             2.0.3    2024-03-13 [1] RSPM ##  irlba              2.3.5.1  2022-10-03 [1] RSPM ##  jquerylib          0.1.4    2021-04-26 [1] RSPM ##  jsonlite           1.8.8    2023-12-04 [1] RSPM ##  KernSmooth         2.23-24  2024-05-17 [3] CRAN (R 4.4.1) ##  knitr              1.48     2024-07-07 [1] RSPM ##  later              1.3.2    2023-12-06 [1] RSPM ##  lattice            0.22-6   2024-03-20 [3] CRAN (R 4.4.1) ##  lazyeval           0.2.2    2019-03-15 [1] RSPM ##  leiden             0.4.3.1  2023-11-17 [1] RSPM ##  lifecycle          1.0.4    2023-11-07 [1] RSPM ##  listenv            0.9.1    2024-01-29 [1] RSPM ##  lmtest             0.9-40   2022-03-21 [1] RSPM ##  magrittr           2.0.3    2022-03-30 [1] RSPM ##  MASS               7.3-60.2 2024-04-26 [3] CRAN (R 4.4.1) ##  Matrix             1.7-0    2024-04-26 [3] CRAN (R 4.4.1) ##  matrixStats        1.3.0    2024-04-11 [1] RSPM ##  memoise            2.0.1    2021-11-26 [1] RSPM ##  mime               0.12     2021-09-28 [1] RSPM ##  miniUI             0.1.1.1  2018-05-18 [1] RSPM ##  munsell            0.5.1    2024-04-01 [1] RSPM ##  nlme               3.1-164  2023-11-27 [3] CRAN (R 4.4.1) ##  parallelly         1.37.1   2024-02-29 [1] RSPM ##  patchwork          1.2.0    2024-01-08 [1] RSPM ##  pbapply            1.7-2    2023-06-27 [1] RSPM ##  pillar             1.9.0    2023-03-22 [1] RSPM ##  pkgbuild           1.4.4    2024-03-17 [1] RSPM ##  pkgconfig          2.0.3    2019-09-22 [1] RSPM ##  pkgdown            2.1.0    2024-07-06 [1] RSPM ##  pkgload            1.4.0    2024-06-28 [1] RSPM ##  plotly             4.10.4   2024-01-13 [1] RSPM ##  plyr               1.8.9    2023-10-02 [1] RSPM ##  png                0.1-8    2022-11-29 [1] RSPM ##  polyclip           1.10-6   2023-09-27 [1] RSPM ##  profvis            0.3.8    2023-05-02 [1] RSPM ##  progressr          0.14.0   2023-08-10 [1] RSPM ##  promises           1.3.0    2024-04-05 [1] RSPM ##  purrr              1.0.2    2023-08-10 [1] RSPM ##  R6                 2.5.1    2021-08-19 [1] RSPM ##  ragg               1.3.2    2024-05-15 [1] RSPM ##  RANN               2.6.1    2019-01-08 [1] RSPM ##  RColorBrewer       1.1-3    2022-04-03 [1] RSPM ##  Rcpp               1.0.12   2024-01-09 [1] RSPM ##  RcppAnnoy          0.0.22   2024-01-23 [1] RSPM ##  RcppHNSW           0.6.0    2024-02-04 [1] RSPM ##  remotes            2.5.0    2024-03-17 [1] RSPM ##  reshape2           1.4.4    2020-04-09 [1] RSPM ##  reticulate         1.38.0   2024-06-19 [1] RSPM ##  rlang              1.1.4    2024-06-04 [1] RSPM ##  rmarkdown          2.27     2024-05-17 [1] RSPM ##  ROCR               1.0-11   2020-05-02 [1] RSPM ##  RSpectra           0.16-1   2022-04-24 [1] RSPM ##  Rtsne              0.17     2023-12-07 [1] RSPM ##  sass               0.4.9    2024-03-15 [1] RSPM ##  scales             1.3.0    2023-11-28 [1] RSPM ##  scattermore        1.2      2023-06-12 [1] RSPM ##  sctransform        0.4.1    2023-10-19 [1] RSPM ##  sessioninfo        1.2.2    2021-12-06 [1] RSPM ##  Seurat           * 5.1.0    2024-05-10 [1] RSPM ##  SeuratObject     * 5.0.2    2024-05-08 [1] RSPM ##  shiny              1.8.1.1  2024-04-02 [1] RSPM ##  sp               * 2.1-4    2024-04-30 [1] RSPM ##  spam               2.10-0   2023-10-23 [1] RSPM ##  spatstat.data      3.1-2    2024-06-21 [1] RSPM ##  spatstat.explore   3.2-7    2024-03-21 [1] RSPM ##  spatstat.geom      3.2-9    2024-02-28 [1] RSPM ##  spatstat.random    3.2-3    2024-02-29 [1] RSPM ##  spatstat.sparse    3.1-0    2024-06-21 [1] RSPM ##  spatstat.utils     3.0-5    2024-06-17 [1] RSPM ##  stringi            1.8.4    2024-05-06 [1] RSPM ##  stringr            1.5.1    2023-11-14 [1] RSPM ##  survival           3.6-4    2024-04-24 [3] CRAN (R 4.4.1) ##  systemfonts        1.1.0    2024-05-15 [1] RSPM ##  tensor             1.5      2012-05-05 [1] RSPM ##  textshaping        0.4.0    2024-05-24 [1] RSPM ##  tibble             3.2.1    2023-03-20 [1] RSPM ##  tidyr              1.3.1    2024-01-24 [1] RSPM ##  tidyselect         1.2.1    2024-03-11 [1] RSPM ##  urlchecker         1.0.1    2021-11-30 [1] RSPM ##  usethis            2.2.3    2024-02-19 [1] RSPM ##  utf8               1.2.4    2023-10-22 [1] RSPM ##  uwot               0.2.2    2024-04-21 [1] RSPM ##  vctrs              0.6.5    2023-12-01 [1] RSPM ##  viridisLite        0.4.2    2023-05-02 [1] RSPM ##  withr              3.0.0    2024-01-16 [1] RSPM ##  xfun               0.45     2024-06-16 [1] RSPM ##  xtable             1.8-4    2019-04-21 [1] RSPM ##  yaml               2.3.9    2024-07-05 [1] RSPM ##  zoo                1.8-12   2023-04-13 [1] RSPM ##  ##  [1] /home/runner/work/_temp/Library ##  [2] /opt/R/4.4.1/lib/R/site-library ##  [3] /opt/R/4.4.1/lib/R/library ##  ## ──────────────────────────────────────────────────────────────────────────────"},{"path":"https://linnykos.github.io/eSVD2/articles/eSVD2.html","id":"purpose","dir":"Articles","previous_headings":"","what":"Purpose","title":"eSVD-DE Overview","text":"simulations meant portable, toy-examples eSVD2, intent demonstrate installation eSVD2 successful. successful installation eSVD2 required . See last section README system/package dependencies used creating simulations. simulations complete less 2 minutes.","code":""},{"path":"https://linnykos.github.io/eSVD2/articles/eSVD2.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"eSVD-DE Overview","text":"Broadly speaking, eSVD-DE (name method, implemented eSVD2 package) pipeline 6 different function calls. procedure starts primarily 3 inputs, dat, either matrix dgCMatrix, n rows (n cells) p columns (p genes). advise making sure row/column either matrix non-zero variance prior using pipeline. covariates, matrix n rows rownames dat columns represent different covariates Notably, contain numerical columns (.e., categorical variables already split numerous indicator variables), columns covariates (strictly speaking) included eSVD matrix factorization model. metadata_individual, factor vector length n denotes cell originates individual.","code":"library(eSVD2) library(Seurat)"},{"path":"https://linnykos.github.io/eSVD2/articles/eSVD2.html","id":"simulating-data","dir":"Articles","previous_headings":"","what":"Simulating data","title":"eSVD-DE Overview","text":"create simple dataset differentially expressed genes via eSVD2::generate_null() function. Seurat also installed, can run following lines well,  separation case control cells purely determined individual covariates Age Sex, case-control status.","code":"set.seed(10) res <- eSVD2::generate_null() covariates <- res$covariates metadata_individual <- res$metadata_individual obs_mat <- res$obs_mat set.seed(10) meta_data <- data.frame(covariates[, c(\"CC\", \"Sex\", \"Age\")]) meta_data$Individual <- metadata_individual seurat_obj <- Seurat::CreateSeuratObject(counts = Matrix::t(obs_mat), meta.data = meta_data) Seurat::VariableFeatures(seurat_obj) <- rownames(seurat_obj) seurat_obj <- Seurat::NormalizeData(seurat_obj) seurat_obj <- Seurat::ScaleData(seurat_obj) seurat_obj <- Seurat::RunPCA(seurat_obj, verbose = F) seurat_obj <- Seurat::RunUMAP(seurat_obj, dims = 1:5)  Seurat::DimPlot(seurat_obj, reduction = \"umap\", group.by = \"CC\")"},{"path":"https://linnykos.github.io/eSVD2/articles/eSVD2.html","id":"using-esvd-de","dir":"Articles","previous_headings":"","what":"Using eSVD-DE","title":"eSVD-DE Overview","text":"Step 1 (Initializing eSVD object): First, initialize object class eSVD, call eSVD_obj. done using eSVD2::initialize_esvd() function. following operations use eSVD_obj calculations usage method. pass inputs dat, covariates, metadata_individual. Notice eSVD2::initialize_esvd() (later, eSVD2::opt_esvd()) always call eSVD2::reparameterization_esvd_covariates() ensure fit remains identifiable. Empirically, found useful set omitted_variables Log_UMI batch variables. (, batch variables.) means eSVD2 reparameterizes variables, fiddle coefficient Log_UMI. found beneficial since coefficient specifically covariate Log_UMI bears special meaning (impacts normalization sequencing depth directly), wish “mix” covariates correlated Log_UMI early. (Overall, strict recommendation, however, found practice beneficial almost instances used eSVD2, tried deviating convention.) typically looks like following. Step 2 (Fitting eSVD object): now fit eSVD. Typically, recommend fitting twice (.e., calling eSVD2::opt_esvd() twice) due non-convex nature objective function. first call eSVD2::opt_esvd(), hold coefficients covariates aside case-control covariate (, denoted \"CC\" remove much case-control covariate effect possible. , second call eSVD2::opt_esvd(), allow coefficients optimized. Note last fit eSVD2::opt_esvd(), set omitted_variables. typical recommendation – good allow coefficients reparameterized right optimization done. Step 3 (Estimating nuisance (.e., -dispersion) parameters): fitting eSVD, need estimate nuisance parameters. Since modeling data via negative binomial, nuisance parameter -dispersion parameter. done via eSVD2::estimate_nuisance() function. Step 4 (Computing posterior): -disperison parameter estimated, now ready compute posterior mean variance cell’s gene expression value. posterior distribution balance fitted eSVD denoised value covariate-adjusted library size. step ensures even though pooled genes denoise single-cell expression matrix, later inflate Type-1 error. done via eSVD2::compute_posterior() function. Step 5 (Computing test statistics): Now can compute test statistics using eSVD2::compute_test_statistic() function. Step 6 (Computing p-values): Lastly, can compute p-values via eSVD2::compute_pvalue() function. visualize p-values, can plot theoretical quantiles observed quantiles. see despite UMAP showing strong differences case control cells, p-values uniformly distributed. shows inflate Type-1 error.","code":"set.seed(10) eSVD_obj <- eSVD2::initialize_esvd(   dat = obs_mat,   covariates = covariates,   metadata_individual = metadata_individual,   case_control_variable = \"CC\",   bool_intercept = T,   k = 5,   lambda = 0.1,   verbose = 0 ) eSVD_obj <- eSVD2::reparameterization_esvd_covariates(   input_obj = eSVD_obj,   fit_name = \"fit_Init\",   omitted_variables = \"Log_UMI\" )  names(eSVD_obj) #> [1] \"dat\"          \"covariates\"   \"param\"        \"fit_Init\"     \"latest_Fit\"   #> [6] \"case_control\" \"individual\" set.seed(10) eSVD_obj <- eSVD2::opt_esvd(   input_obj = eSVD_obj,   l2pen = 0.1,   max_iter = 100,   offset_variables = setdiff(colnames(eSVD_obj$covariates), \"CC\"),   tol = 1e-6,   verbose = 0,   fit_name = \"fit_First\",   fit_previous = \"fit_Init\" ) eSVD_obj <- eSVD2::reparameterization_esvd_covariates(   input_obj = eSVD_obj,   fit_name = \"fit_First\",   omitted_variables = \"Log_UMI\" )  set.seed(10) eSVD_obj <- eSVD2::opt_esvd(   input_obj = eSVD_obj,   l2pen = 0.1,   max_iter = 100,   offset_variables = NULL,   tol = 1e-6,   verbose = 0,   fit_name = \"fit_Second\",   fit_previous = \"fit_First\" )  eSVD_obj <- eSVD2::reparameterization_esvd_covariates(   input_obj = eSVD_obj,   fit_name = \"fit_Second\",   omitted_variables = NULL )  names(eSVD_obj) #> [1] \"dat\"          \"covariates\"   \"param\"        \"fit_Init\"     \"latest_Fit\"   #> [6] \"case_control\" \"individual\"   \"fit_First\"    \"fit_Second\" set.seed(10) eSVD_obj <- eSVD2::estimate_nuisance(   input_obj = eSVD_obj,   bool_covariates_as_library = TRUE,   bool_library_includes_interept = TRUE,   bool_use_log = FALSE,   min_val = 1e-4,   verbose = 0 )  names(eSVD_obj) #> [1] \"dat\"          \"covariates\"   \"param\"        \"fit_Init\"     \"latest_Fit\"   #> [6] \"case_control\" \"individual\"   \"fit_First\"    \"fit_Second\" set.seed(10) eSVD_obj <- eSVD2::compute_posterior(   input_obj = eSVD_obj,   bool_adjust_covariates = FALSE,   alpha_max = 100,   bool_covariates_as_library = TRUE,   bool_stabilize_underdispersion = TRUE,   library_min = 1,   pseudocount = 0 )  names(eSVD_obj) #> [1] \"dat\"          \"covariates\"   \"param\"        \"fit_Init\"     \"latest_Fit\"   #> [6] \"case_control\" \"individual\"   \"fit_First\"    \"fit_Second\" set.seed(10) eSVD_obj <- eSVD2::compute_test_statistic(input_obj = eSVD_obj, verbose = 0)  names(eSVD_obj) #>  [1] \"dat\"          \"covariates\"   \"param\"        \"fit_Init\"     \"latest_Fit\"   #>  [6] \"case_control\" \"individual\"   \"fit_First\"    \"fit_Second\"   \"teststat_vec\" #> [11] \"case_mean\"    \"control_mean\" set.seed(10) eSVD_obj <- eSVD2::compute_pvalue(input_obj = eSVD_obj)  names(eSVD_obj) #>  [1] \"dat\"          \"covariates\"   \"param\"        \"fit_Init\"     \"latest_Fit\"   #>  [6] \"case_control\" \"individual\"   \"fit_First\"    \"fit_Second\"   \"teststat_vec\" #> [11] \"case_mean\"    \"control_mean\" \"pvalue_list\" pvalue_vec <- 10 ^ (-eSVD_obj$pvalue_list$log10pvalue) graphics::plot(   x = sort(pvalue_vec),   y = seq(0, 1, length.out = length(pvalue_vec)),   asp = TRUE,   pch = 16,   xlab = \"Observed quantile\",   ylab = \"Theoretical quantile\" ) graphics::lines(   x = c(0, 1),   y = c(0, 1),   col = \"red\",   lty = 2,   lwd = 2 )"},{"path":"https://linnykos.github.io/eSVD2/articles/eSVD2.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"eSVD-DE Overview","text":"following shows suggested package versions developer (GitHub username: linnykos) used developing eSVD2 package.","code":"devtools::session_info() #> ─ Session info ─────────────────────────────────────────────────────────────── #>  setting  value #>  version  R version 4.4.1 (2024-06-14) #>  os       Ubuntu 22.04.4 LTS #>  system   x86_64, linux-gnu #>  ui       X11 #>  language en #>  collate  C.UTF-8 #>  ctype    C.UTF-8 #>  tz       UTC #>  date     2024-07-13 #>  pandoc   3.1.11 @ /opt/hostedtoolcache/pandoc/3.1.11/x64/ (via rmarkdown) #>  #> ─ Packages ─────────────────────────────────────────────────────────────────── #>  package          * version  date (UTC) lib source #>  abind              1.4-5    2016-07-21 [1] RSPM #>  bslib              0.7.0    2024-03-29 [1] RSPM #>  cachem             1.1.0    2024-05-16 [1] RSPM #>  cli                3.6.3    2024-06-21 [1] RSPM #>  cluster            2.1.6    2023-12-01 [3] CRAN (R 4.4.1) #>  codetools          0.2-20   2024-03-31 [3] CRAN (R 4.4.1) #>  colorspace         2.1-0    2023-01-23 [1] RSPM #>  cowplot            1.1.3    2024-01-22 [1] RSPM #>  data.table         1.15.4   2024-03-30 [1] RSPM #>  deldir             2.0-4    2024-02-28 [1] RSPM #>  desc               1.4.3    2023-12-10 [1] RSPM #>  devtools           2.4.5    2022-10-11 [1] RSPM #>  digest             0.6.36   2024-06-23 [1] RSPM #>  dotCall64          1.1-1    2023-11-28 [1] RSPM #>  dplyr              1.1.4    2023-11-17 [1] RSPM #>  ellipsis           0.3.2    2021-04-29 [1] RSPM #>  eSVD2            * 1.0.1.01 2024-07-13 [1] local #>  evaluate           0.24.0   2024-06-10 [1] RSPM #>  fansi              1.0.6    2023-12-08 [1] RSPM #>  farver             2.1.2    2024-05-13 [1] RSPM #>  fastDummies        1.7.3    2023-07-06 [1] RSPM #>  fastmap            1.2.0    2024-05-15 [1] RSPM #>  fitdistrplus       1.2-1    2024-07-12 [1] RSPM #>  foreach            1.5.2    2022-02-02 [1] RSPM #>  fs                 1.6.4    2024-04-25 [1] RSPM #>  future             1.33.2   2024-03-26 [1] RSPM #>  future.apply       1.11.2   2024-03-28 [1] RSPM #>  generics           0.1.3    2022-07-05 [1] RSPM #>  ggplot2            3.5.1    2024-04-23 [1] RSPM #>  ggrepel            0.9.5    2024-01-10 [1] RSPM #>  ggridges           0.5.6    2024-01-23 [1] RSPM #>  glmnet             4.1-8    2023-08-22 [1] RSPM #>  globals            0.16.3   2024-03-08 [1] RSPM #>  glue               1.7.0    2024-01-09 [1] RSPM #>  gmp                0.7-4    2024-01-15 [1] RSPM #>  goftest            1.2-3    2021-10-07 [1] RSPM #>  gridExtra          2.3      2017-09-09 [1] RSPM #>  gtable             0.3.5    2024-04-22 [1] RSPM #>  highr              0.11     2024-05-26 [1] RSPM #>  htmltools          0.5.8.1  2024-04-04 [1] RSPM #>  htmlwidgets        1.6.4    2023-12-06 [1] RSPM #>  httpuv             1.6.15   2024-03-26 [1] RSPM #>  httr               1.4.7    2023-08-15 [1] RSPM #>  ica                1.0-3    2022-07-08 [1] RSPM #>  igraph             2.0.3    2024-03-13 [1] RSPM #>  irlba              2.3.5.1  2022-10-03 [1] RSPM #>  iterators          1.0.14   2022-02-05 [1] RSPM #>  jquerylib          0.1.4    2021-04-26 [1] RSPM #>  jsonlite           1.8.8    2023-12-04 [1] RSPM #>  KernSmooth         2.23-24  2024-05-17 [3] CRAN (R 4.4.1) #>  knitr              1.48     2024-07-07 [1] RSPM #>  labeling           0.4.3    2023-08-29 [1] RSPM #>  later              1.3.2    2023-12-06 [1] RSPM #>  lattice            0.22-6   2024-03-20 [3] CRAN (R 4.4.1) #>  lazyeval           0.2.2    2019-03-15 [1] RSPM #>  leiden             0.4.3.1  2023-11-17 [1] RSPM #>  lifecycle          1.0.4    2023-11-07 [1] RSPM #>  listenv            0.9.1    2024-01-29 [1] RSPM #>  lmtest             0.9-40   2022-03-21 [1] RSPM #>  locfdr             1.1-8    2015-07-15 [1] RSPM #>  magrittr           2.0.3    2022-03-30 [1] RSPM #>  MASS               7.3-60.2 2024-04-26 [3] CRAN (R 4.4.1) #>  Matrix             1.7-0    2024-04-26 [3] CRAN (R 4.4.1) #>  matrixStats        1.3.0    2024-04-11 [1] RSPM #>  memoise            2.0.1    2021-11-26 [1] RSPM #>  mime               0.12     2021-09-28 [1] RSPM #>  miniUI             0.1.1.1  2018-05-18 [1] RSPM #>  munsell            0.5.1    2024-04-01 [1] RSPM #>  nlme               3.1-164  2023-11-27 [3] CRAN (R 4.4.1) #>  parallelly         1.37.1   2024-02-29 [1] RSPM #>  patchwork          1.2.0    2024-01-08 [1] RSPM #>  pbapply            1.7-2    2023-06-27 [1] RSPM #>  pillar             1.9.0    2023-03-22 [1] RSPM #>  pkgbuild           1.4.4    2024-03-17 [1] RSPM #>  pkgconfig          2.0.3    2019-09-22 [1] RSPM #>  pkgdown            2.1.0    2024-07-06 [1] RSPM #>  pkgload            1.4.0    2024-06-28 [1] RSPM #>  plotly             4.10.4   2024-01-13 [1] RSPM #>  plyr               1.8.9    2023-10-02 [1] RSPM #>  png                0.1-8    2022-11-29 [1] RSPM #>  polyclip           1.10-6   2023-09-27 [1] RSPM #>  profvis            0.3.8    2023-05-02 [1] RSPM #>  progressr          0.14.0   2023-08-10 [1] RSPM #>  promises           1.3.0    2024-04-05 [1] RSPM #>  purrr              1.0.2    2023-08-10 [1] RSPM #>  R6                 2.5.1    2021-08-19 [1] RSPM #>  ragg               1.3.2    2024-05-15 [1] RSPM #>  RANN               2.6.1    2019-01-08 [1] RSPM #>  RColorBrewer       1.1-3    2022-04-03 [1] RSPM #>  Rcpp             * 1.0.12   2024-01-09 [1] RSPM #>  RcppAnnoy          0.0.22   2024-01-23 [1] RSPM #>  RcppHNSW           0.6.0    2024-02-04 [1] RSPM #>  remotes            2.5.0    2024-03-17 [1] RSPM #>  reshape2           1.4.4    2020-04-09 [1] RSPM #>  reticulate         1.38.0   2024-06-19 [1] RSPM #>  rlang              1.1.4    2024-06-04 [1] RSPM #>  rmarkdown          2.27     2024-05-17 [1] RSPM #>  Rmpfr              0.9-5    2024-01-21 [1] RSPM #>  ROCR               1.0-11   2020-05-02 [1] RSPM #>  RSpectra           0.16-1   2022-04-24 [1] RSPM #>  Rtsne              0.17     2023-12-07 [1] RSPM #>  sass               0.4.9    2024-03-15 [1] RSPM #>  scales             1.3.0    2023-11-28 [1] RSPM #>  scattermore        1.2      2023-06-12 [1] RSPM #>  sctransform        0.4.1    2023-10-19 [1] RSPM #>  sessioninfo        1.2.2    2021-12-06 [1] RSPM #>  Seurat           * 5.1.0    2024-05-10 [1] RSPM #>  SeuratObject     * 5.0.2    2024-05-08 [1] RSPM #>  shape              1.4.6.1  2024-02-23 [1] RSPM #>  shiny              1.8.1.1  2024-04-02 [1] RSPM #>  sp               * 2.1-4    2024-04-30 [1] RSPM #>  spam               2.10-0   2023-10-23 [1] RSPM #>  spatstat.data      3.1-2    2024-06-21 [1] RSPM #>  spatstat.explore   3.2-7    2024-03-21 [1] RSPM #>  spatstat.geom      3.2-9    2024-02-28 [1] RSPM #>  spatstat.random    3.2-3    2024-02-29 [1] RSPM #>  spatstat.sparse    3.1-0    2024-06-21 [1] RSPM #>  spatstat.utils     3.0-5    2024-06-17 [1] RSPM #>  stringi            1.8.4    2024-05-06 [1] RSPM #>  stringr            1.5.1    2023-11-14 [1] RSPM #>  survival           3.6-4    2024-04-24 [3] CRAN (R 4.4.1) #>  systemfonts        1.1.0    2024-05-15 [1] RSPM #>  tensor             1.5      2012-05-05 [1] RSPM #>  textshaping        0.4.0    2024-05-24 [1] RSPM #>  tibble             3.2.1    2023-03-20 [1] RSPM #>  tidyr              1.3.1    2024-01-24 [1] RSPM #>  tidyselect         1.2.1    2024-03-11 [1] RSPM #>  urlchecker         1.0.1    2021-11-30 [1] RSPM #>  usethis            2.2.3    2024-02-19 [1] RSPM #>  utf8               1.2.4    2023-10-22 [1] RSPM #>  uwot               0.2.2    2024-04-21 [1] RSPM #>  vctrs              0.6.5    2023-12-01 [1] RSPM #>  viridisLite        0.4.2    2023-05-02 [1] RSPM #>  withr              3.0.0    2024-01-16 [1] RSPM #>  xfun               0.45     2024-06-16 [1] RSPM #>  xtable             1.8-4    2019-04-21 [1] RSPM #>  yaml               2.3.9    2024-07-05 [1] RSPM #>  zoo                1.8-12   2023-04-13 [1] RSPM #>  #>  [1] /home/runner/work/_temp/Library #>  [2] /opt/R/4.4.1/lib/R/site-library #>  [3] /opt/R/4.4.1/lib/R/library #>  #> ──────────────────────────────────────────────────────────────────────────────"},{"path":"https://linnykos.github.io/eSVD2/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Kevin Z Lin. Author, maintainer.","code":""},{"path":"https://linnykos.github.io/eSVD2/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Lin K (2024). eSVD2: eSVD2 performing eSVD-DE cohort-wide differential expression analysis. R package version 1.0.1.01, https://linnykos.github.io/eSVD2/.","code":"@Manual{,   title = {eSVD2: eSVD2 for performing the eSVD-DE for cohort-wide differential expression analysis},   author = {Kevin Z Lin},   year = {2024},   note = {R package version 1.0.1.01},   url = {https://linnykos.github.io/eSVD2/}, }"},{"path":"https://linnykos.github.io/eSVD2/index.html","id":"purpose","dir":"","previous_headings":"","what":"eSVD2 for performing the eSVD-DE for cohort-wide differential expression analysis","title":"eSVD2 for performing the eSVD-DE for cohort-wide differential expression analysis","text":"repository contains functions perform eSVD-DE (package eSVD2, version 1.0.0 June 16, 2024) downstream analysis, paper “eSVD-DE: cohort-wide differential expression single-cell RNA-seq data using exponential-family embeddings”. See companion GitHub package https://github.com/linnykos/eSVD2_examples analyses performed paper. (Note, original analysis performed eSVD2 version 0.0.0.0071, working make code https://github.com/linnykos/eSVD2_examples compatibile latest version eSVD2.) code developed tested primarily R 4.3.2. 2023 Macbook Pro (macOS Sonoma 14.2.1) equipped Apple M2 Max processor (32 Gb RAM).","code":""},{"path":"https://linnykos.github.io/eSVD2/index.html","id":"tutorials-and-vignettes","dir":"","previous_headings":"","what":"Tutorials and vignettes","title":"eSVD2 for performing the eSVD-DE for cohort-wide differential expression analysis","text":"Please see https://linnykos.github.io/eSVD2/index.html -depth tutorials vignettes use Tilted-CCA.","code":""},{"path":"https://linnykos.github.io/eSVD2/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"eSVD2 for performing the eSVD-DE for cohort-wide differential expression analysis","text":"package can installed devtools R. package depends several packages. include irlba, glmnet, locfdr, Matrix, matrixStats, Rmpfr, RSpectra, sparseMatrixStats. See last section README see (.e., CRAN, Bioconductor, GitHub) download packages. noted Rmpfr sometimes tricky install due required C++ libraries. installation dependencies, installation tiltedCCA package takes modest time (less 10 minutes). installation time mainly consists time compile C++ code since matrix factorization optimization written using Rcpp faster performance. (Solution posted December 24, 2023): come across error, likely need downgrade version Matrix 1.6-1.1. See https://github.com/bwlewis/irlba/issues/70#issuecomment-1826900769. Hence, R console,","code":"library(\"devtools\") devtools::install_github(\"linnykos/eSVD2\") Error in irlba::irlba() :    function 'as_cholmod_sparse' not provided by package 'Matrix' remove.packages(\"SeuratObject\") remove.packages(\"Matrix\") remove.packages(\"irlba\") install.packages(\"Matrix\", type = \"source\") install.packages(\"irlba\", type = \"source\") install.packages(\"SeuratObject\")"},{"path":"https://linnykos.github.io/eSVD2/index.html","id":"small-simulated-dataset-to-demo-the-software","dir":"","previous_headings":"","what":"Small simulated dataset to demo the software","title":"eSVD2 for performing the eSVD-DE for cohort-wide differential expression analysis","text":"See https://linnykos.github.io/eSVD2/articles/eSVD2.html small demo use eSVD2.","code":""},{"path":"https://linnykos.github.io/eSVD2/index.html","id":"setup","dir":"","previous_headings":"","what":"Setup","title":"eSVD2 for performing the eSVD-DE for cohort-wide differential expression analysis","text":"following shows suggested package versions developer (GitHub username: linnykos) used developing eSVD2 package.","code":"> devtools::session_info() ─ Session info ──────────────────────────  setting  value  version  R version 4.3.2 (2023-10-31)  os       macOS Sonoma 14.2.1  system   aarch64, darwin20  ui       RStudio  language (EN)  collate  en_US.UTF-8  ctype    en_US.UTF-8  tz       America/Chicago  date     2024-06-16  rstudio  2024.04.1+748 Chocolate Cosmos (desktop)  pandoc   NA  ─ Packages ──────────────────────────────  package     * version date (UTC) lib source  brio          1.1.5   2024-04-24 [1] CRAN (R 4.3.1)  cachem        1.1.0   2024-05-16 [1] CRAN (R 4.3.3)  cli           3.6.2   2023-12-11 [1] CRAN (R 4.3.1)  devtools      2.4.5   2022-10-11 [1] CRAN (R 4.3.0)  digest        0.6.35  2024-03-11 [1] CRAN (R 4.3.1)  ellipsis      0.3.2   2021-04-29 [1] CRAN (R 4.3.0)  eSVD2       * 1.0.0   2024-06-17 [1] local  fastmap       1.2.0   2024-05-15 [1] CRAN (R 4.3.3)  fs            1.6.4   2024-04-25 [1] CRAN (R 4.3.1)  glue          1.7.0   2024-01-09 [1] CRAN (R 4.3.1)  htmltools     0.5.8.1 2024-04-04 [1] CRAN (R 4.3.1)  htmlwidgets   1.6.4   2023-12-06 [1] CRAN (R 4.3.1)  httpuv        1.6.15  2024-03-26 [1] CRAN (R 4.3.1)  later         1.3.2   2023-12-06 [1] CRAN (R 4.3.1)  lifecycle     1.0.4   2023-11-07 [1] CRAN (R 4.3.1)  magrittr      2.0.3   2022-03-30 [1] CRAN (R 4.3.0)  memoise       2.0.1   2021-11-26 [1] CRAN (R 4.3.0)  mime          0.12    2021-09-28 [1] CRAN (R 4.3.0)  miniUI        0.1.1.1 2018-05-18 [1] CRAN (R 4.3.0)  pkgbuild      1.4.4   2024-03-17 [1] CRAN (R 4.3.1)  pkgload       1.3.4   2024-01-16 [1] CRAN (R 4.3.1)  profvis       0.3.8   2023-05-02 [1] CRAN (R 4.3.0)  promises      1.3.0   2024-04-05 [1] CRAN (R 4.3.1)  purrr         1.0.2   2023-08-10 [1] CRAN (R 4.3.0)  R6            2.5.1   2021-08-19 [1] CRAN (R 4.3.0)  Rcpp        * 1.0.12  2024-01-09 [1] CRAN (R 4.3.1)  remotes       2.5.0   2024-03-17 [1] CRAN (R 4.3.1)  rlang         1.1.4   2024-06-04 [1] CRAN (R 4.3.3)  rstudioapi    0.16.0  2024-03-24 [1] CRAN (R 4.3.1)  sessioninfo   1.2.2   2021-12-06 [1] CRAN (R 4.3.0)  shiny         1.8.1.1 2024-04-02 [1] CRAN (R 4.3.1)  stringi       1.8.4   2024-05-06 [1] CRAN (R 4.3.1)  stringr       1.5.1   2023-11-14 [1] CRAN (R 4.3.1)  testthat    * 3.2.1.1 2024-04-14 [1] CRAN (R 4.3.1)  urlchecker    1.0.1   2021-11-30 [1] CRAN (R 4.3.0)  usethis       2.2.3   2024-02-19 [1] CRAN (R 4.3.1)  vctrs         0.6.5   2023-12-01 [1] CRAN (R 4.3.1)  xtable        1.8-4   2019-04-21 [1] CRAN (R 4.3.0)   [1] /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/library"},{"path":"https://linnykos.github.io/eSVD2/reference/compute_posterior.default.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute posterior according to Gamma-Poisson model for matrices and sparse matrices. — compute_posterior.default","title":"Compute posterior according to Gamma-Poisson model for matrices and sparse matrices. — compute_posterior.default","text":"Compute posterior according Gamma-Poisson model matrices sparse matrices.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_posterior.default.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute posterior according to Gamma-Poisson model for matrices and sparse matrices. — compute_posterior.default","text":"","code":"# Default S3 method compute_posterior(   input_obj,   case_control_variable,   covariates,   esvd_res,   library_size_variable,   nuisance_vec,   alpha_max = 1000,   bool_adjust_covariates = F,   bool_covariates_as_library = T,   bool_library_includes_interept = T,   bool_return_components = F,   bool_stabilize_underdispersion = T,   library_min = 0.1,   nuisance_lower_quantile = 0.01,   pseudocount = 0,   ... )"},{"path":"https://linnykos.github.io/eSVD2/reference/compute_posterior.default.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute posterior according to Gamma-Poisson model for matrices and sparse matrices. — compute_posterior.default","text":"input_obj Dataset (either matrix dgCMatrix) \\(n\\) rows represent cells \\(p\\) columns represent genes. rows columns matrix named. case_control_variable string column name covariates depicts case-control status cell. Notably, binary variable 1 hard-coded describe case, 0 describe control. covariates matrix object \\(n\\) rows rownames dat columns represent different covariates. Notably, contain numerical columns (.e., categorical variables already split numerous indicator variables). esvd_res Output opt_esvd.default, notably elements x_mat, y_mat z_mat library_size_variable string variable name (must covariates) variable denotes sequenced (.e., observed) library size. nuisance_vec Vector non-negative numerics length ncol(input_obj), output estimate_nuisance.default. alpha_max Maximum value numerator computing posterior, default 1e3. bool_adjust_covariates Boolean adjust numerator posterior donor covariates, default FALSE. parameter experimental, yet encountered scenario useful set TRUE. bool_covariates_as_library Boolean include donor covariates effects adjusted library size, default TRUE. bool_library_includes_interept Boolean intercept term eSVD matrix factorization included calculation covariate-adjusted library size, default TRUE. bool_return_components Boolean return numerator denominator posterior terms well (matrices cell--gene matrices), default FALSE. bool_stabilize_underdispersion Boolean stabilize -dispersion parameter, specifically rescale -dispersions global mean -disperion less 1, default TRUE. library_min covariate-adjusted library size smaller value set value, default 0.1. nuisance_lower_quantile nuisance values smaller quantile set quantile. pseudocount additional count added count matrix, default 0. ... Additional parameters.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_posterior.default.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute posterior according to Gamma-Poisson model for matrices and sparse matrices. — compute_posterior.default","text":"list elements posterior_mean_mat posterior_var_mat","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_posterior.eSVD.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute posterior according to Gamma-Poisson model for eSVD object — compute_posterior.eSVD","title":"Compute posterior according to Gamma-Poisson model for eSVD object — compute_posterior.eSVD","text":"posterior computed based whatever input_obj$latest_Fit set .","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_posterior.eSVD.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute posterior according to Gamma-Poisson model for eSVD object — compute_posterior.eSVD","text":"","code":"# S3 method for class 'eSVD' compute_posterior(   input_obj,   alpha_max = 1000,   bool_adjust_covariates = F,   bool_covariates_as_library = T,   bool_return_components = F,   bool_stabilize_underdispersion = T,   library_min = 0.1,   nuisance_lower_quantile = 0.01,   pseudocount = 0,   ... )"},{"path":"https://linnykos.github.io/eSVD2/reference/compute_posterior.eSVD.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute posterior according to Gamma-Poisson model for eSVD object — compute_posterior.eSVD","text":"input_obj eSVD object outputed opt_esvd.eSVD. alpha_max Maximum value numerator computing posterior, default 1e3. bool_adjust_covariates Boolean adjust numerator posterior donor covariates, default FALSE. parameter experimental, yet encountered scenario useful set TRUE. bool_covariates_as_library Boolean include donor covariates effects adjusted library size, default TRUE bool_return_components Boolean return numerator denominator posterior terms well (matrices cell--gene matrices), default FALSE bool_stabilize_underdispersion Boolean stabilize -dispersion parameter, specifically rescale -dispersions global mean -disperion less 1, default TRUE library_min covariate-adjusted library size smaller value set value, default 0.1. nuisance_lower_quantile nuisance values smaller quantile set quantile, default 0.01 pseudocount additional count added count matrix, default 0. ... Additional parameters.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_posterior.eSVD.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute posterior according to Gamma-Poisson model for eSVD object — compute_posterior.eSVD","text":"eSVD object posterior_mean_mat posterior_var_mat appended list input_obj[[input_obj[[\"latest_Fit\"]]]].","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_posterior.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute posterior according to Gamma-Poisson model — compute_posterior","title":"Compute posterior according to Gamma-Poisson model — compute_posterior","text":"Generic function interface","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_posterior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute posterior according to Gamma-Poisson model — compute_posterior","text":"","code":"compute_posterior(input_obj, ...)"},{"path":"https://linnykos.github.io/eSVD2/reference/compute_posterior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute posterior according to Gamma-Poisson model — compute_posterior","text":"input_obj Main object ... Additional parameters","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_posterior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute posterior according to Gamma-Poisson model — compute_posterior","text":"Output dependent class input_obj","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_pvalue.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute p-values — compute_pvalue","title":"Compute p-values — compute_pvalue","text":"Compute p-values","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_pvalue.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute p-values — compute_pvalue","text":"","code":"compute_pvalue(input_obj, verbose = 0, ...)"},{"path":"https://linnykos.github.io/eSVD2/reference/compute_pvalue.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute p-values — compute_pvalue","text":"input_obj eSVD object outputed compute_test_statistic. verbose Integer. ... Additional parameters.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_pvalue.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute p-values — compute_pvalue","text":"eSVD object added element \"pvalue_list\"","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_test_statistic.default.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute test statistics for matrices — compute_test_statistic.default","title":"Compute test statistics for matrices — compute_test_statistic.default","text":"Compute test statistics matrices","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_test_statistic.default.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute test statistics for matrices — compute_test_statistic.default","text":"","code":"# Default S3 method compute_test_statistic(   input_obj,   posterior_var_mat,   case_individuals,   control_individuals,   individual_vec,   verbose = 0,   ... )"},{"path":"https://linnykos.github.io/eSVD2/reference/compute_test_statistic.default.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute test statistics for matrices — compute_test_statistic.default","text":"input_obj Posterior mean matrix (matrix) \\(n\\) rows represent cells \\(p\\) columns represent genes. rows columns matrix named. posterior_var_mat Posterior variance matrix (matrix) \\(n\\) rows represent cells \\(p\\) columns represent genes. rows columns matrix input_obj. case_individuals Vector strings representing individuals metadata[,covariate_individual] case individuals. control_individuals Vector strings representing individuals metadata[,covariate_individual] control individuals. individual_vec Vector strings length \\(n\\) (.e., number cells) denote cell originates individual. verbose Integer. ... Additional parameters.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_test_statistic.default.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute test statistics for matrices — compute_test_statistic.default","text":"vector test statistics length ncol(input_obj)","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_test_statistic.eSVD.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute test statistics for eSVD object — compute_test_statistic.eSVD","title":"Compute test statistics for eSVD object — compute_test_statistic.eSVD","text":"Compute test statistics eSVD object","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_test_statistic.eSVD.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute test statistics for eSVD object — compute_test_statistic.eSVD","text":"","code":"# S3 method for class 'eSVD' compute_test_statistic(input_obj, verbose = 0, ...)"},{"path":"https://linnykos.github.io/eSVD2/reference/compute_test_statistic.eSVD.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute test statistics for eSVD object — compute_test_statistic.eSVD","text":"input_obj eSVD object outputed compute_posterior.eSVD. verbose Integer. ... Additional parameters.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_test_statistic.eSVD.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute test statistics for eSVD object — compute_test_statistic.eSVD","text":"eSVD object added element \"teststat_vec\"","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_test_statistic.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute test statistics — compute_test_statistic","title":"Compute test statistics — compute_test_statistic","text":"Generic function interface","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_test_statistic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute test statistics — compute_test_statistic","text":"","code":"compute_test_statistic(input_obj, ...)"},{"path":"https://linnykos.github.io/eSVD2/reference/compute_test_statistic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute test statistics — compute_test_statistic","text":"input_obj Main object ... Additional parameters","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_test_statistic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute test statistics — compute_test_statistic","text":"Output dependent class input_obj","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/data_loader.html","id":null,"dir":"Reference","previous_headings":"","what":"Internal data loader function — data_loader","title":"Internal data loader function — data_loader","text":"Internal data loader function","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/data_loader.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Internal data loader function — data_loader","text":"","code":"data_loader(mat)"},{"path":"https://linnykos.github.io/eSVD2/reference/data_loader.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Internal data loader function — data_loader","text":"mat matrix","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/data_loader.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Internal data loader function — data_loader","text":"pointer","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/dot-compute_df.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the degree of freedom — .compute_df","title":"Compute the degree of freedom — .compute_df","text":"intermediary function used compute_pvalue","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/dot-compute_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the degree of freedom — .compute_df","text":"","code":".compute_df(input_obj)"},{"path":"https://linnykos.github.io/eSVD2/reference/dot-compute_df.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the degree of freedom — .compute_df","text":"input_obj eSVD object outputed compute_test_statistic.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/dot-compute_df.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute the degree of freedom — .compute_df","text":"named vector degree--freedom values, one gene","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/dot-reparameterize.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to reparameterize two matrices — .reparameterize","title":"Function to reparameterize two matrices — .reparameterize","text":"test","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/dot-reparameterize.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to reparameterize two matrices — .reparameterize","text":"","code":".reparameterize(x_mat, y_mat, equal_covariance)"},{"path":"https://linnykos.github.io/eSVD2/reference/dot-reparameterize.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to reparameterize two matrices — .reparameterize","text":"x_mat matrix dimension n k y_mat matrix dimension p k equal_covariance boolean","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/dot-reparameterize.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to reparameterize two matrices — .reparameterize","text":"list two matrices","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/dot-reparameterize.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Function to reparameterize two matrices — .reparameterize","text":"Designed output matrices dimension x_mat y_mat, linearly transformed x_mat %*% t(y_mat) preserved either x_mat %*% t(x_mat) diagonal equal y_mat %*% t(y_mat) (equal_covariance FALSE) x_mat %*% t(x_mat)/nrow(x_mat) diagonal equal y_mat %*% t(y_mat)/nrow(y_mat) (equal_covariance TRUE)","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/estimate_nuisance.default.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate nuisance values for matrix or sparse matrices. — estimate_nuisance.default","title":"Estimate nuisance values for matrix or sparse matrices. — estimate_nuisance.default","text":"Estimate nuisance values matrix sparse matrices.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/estimate_nuisance.default.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate nuisance values for matrix or sparse matrices. — estimate_nuisance.default","text":"","code":"# Default S3 method estimate_nuisance(   input_obj,   mean_mat,   library_mat,   bool_use_log = F,   min_val = 1e-04,   verbose = 0,   ... )"},{"path":"https://linnykos.github.io/eSVD2/reference/estimate_nuisance.default.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate nuisance values for matrix or sparse matrices. — estimate_nuisance.default","text":"input_obj Dataset (either matrix dgCMatrix) \\(n\\) rows represent cells \\(p\\) columns represent genes. rows columns matrix named. mean_mat matrix \\(n\\) rows \\(p\\) columns represents expected value entry. library_mat matrix \\(n\\) rows \\(p\\) columns represents library size entry. bool_use_log Boolean nuisance (.e., -dispersion) parameter estimated log scale, default FALSE. min_val Minimum value nuisance parameter. verbose Integer. ... Additional parameters.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/estimate_nuisance.default.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate nuisance values for matrix or sparse matrices. — estimate_nuisance.default","text":"Vector length \\(p\\)","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/estimate_nuisance.eSVD.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate nuisance values for eSVD objects (i.e., over-dispersion) — estimate_nuisance.eSVD","title":"Estimate nuisance values for eSVD objects (i.e., over-dispersion) — estimate_nuisance.eSVD","text":"Assumes Gamma-Poisson model mean variance proportionally related.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/estimate_nuisance.eSVD.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate nuisance values for eSVD objects (i.e., over-dispersion) — estimate_nuisance.eSVD","text":"","code":"# S3 method for class 'eSVD' estimate_nuisance(   input_obj,   bool_covariates_as_library = F,   bool_library_includes_interept = T,   bool_use_log = F,   min_val = 1e-04,   verbose = 0,   ... )"},{"path":"https://linnykos.github.io/eSVD2/reference/estimate_nuisance.eSVD.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate nuisance values for eSVD objects (i.e., over-dispersion) — estimate_nuisance.eSVD","text":"input_obj eSVD object outputed opt_esvd.eSVD. Specifically, nuisance parameters estimated based fit input_obj[[input_obj[[\"latest_Fit\"]]]]. bool_covariates_as_library Boolean adjust numerator posterior donor covariates, default FALSE. parameter experimental, yet encountered scenario useful set TRUE. bool_library_includes_interept Boolean intercept term eSVD matrix factorization included calculation covariate-adjusted library size, default TRUE. bool_use_log Boolean nuisance (.e., -dispersion) parameter estimated log scale, default FALSE. min_val Minimum value nuisance parameter. verbose Integer. ... Additional parameters.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/estimate_nuisance.eSVD.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate nuisance values for eSVD objects (i.e., over-dispersion) — estimate_nuisance.eSVD","text":"eSVD object nuisance_vec appended list input_obj[[input_obj[[\"latest_Fit\"]]]].","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/estimate_nuisance.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate nuisance values — estimate_nuisance","title":"Estimate nuisance values — estimate_nuisance","text":"Generic function interface","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/estimate_nuisance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate nuisance values — estimate_nuisance","text":"","code":"estimate_nuisance(input_obj, ...)"},{"path":"https://linnykos.github.io/eSVD2/reference/estimate_nuisance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate nuisance values — estimate_nuisance","text":"input_obj Main object ... Additional parameters","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/estimate_nuisance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate nuisance values — estimate_nuisance","text":"Output dependent class input_obj","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/esvd_family.html","id":null,"dir":"Reference","previous_headings":"","what":"Internal Constructor for distribution family — esvd_family","title":"Internal Constructor for distribution family — esvd_family","text":"Internal Constructor distribution family","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/esvd_family.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Internal Constructor for distribution family — esvd_family","text":"","code":"esvd_family(family)"},{"path":"https://linnykos.github.io/eSVD2/reference/esvd_family.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Internal Constructor for distribution family — esvd_family","text":"family string","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/esvd_family.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Internal Constructor for distribution family — esvd_family","text":"object conversion functions","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/fisher_test.html","id":null,"dir":"Reference","previous_headings":"","what":"Fisher's exact test — fisher_test","title":"Fisher's exact test — fisher_test","text":"Perform Fisher's exact test. formula https://www.pathwaycommons.org/guide/primers/statistics/fishers_exact_test/","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/fisher_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fisher's exact test — fisher_test","text":"","code":"fisher_test(set1_genes, set2_genes, all_genes, verbose = 0)"},{"path":"https://linnykos.github.io/eSVD2/reference/fisher_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fisher's exact test — fisher_test","text":"set1_genes vector characters resulting gene list set2_genes vector characters gene list comparing all_genes vector characters genes \"universe\". include genes set1_genes set2_genes. verbose Numeric","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/fisher_test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fisher's exact test — fisher_test","text":"list : pvalue p-value, set_bg_len number genes all_genes set2_genes, set_overlap_len number genes set1_genes set2_genes, set1_len number genes set1_genes, set2_len number genes set2_genes.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/format_covariates.html","id":null,"dir":"Reference","previous_headings":"","what":"Format covariates — format_covariates","title":"Format covariates — format_covariates","text":"Mainly, method splits categorical variables (`factor` variables) indicator variables (.e., one-hot encoding), dropping last level, rescales numerical variables (center ), computes \"Log_UMI\" (.e., log total counts) cell. \"Log_UMI\" added column.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/format_covariates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Format covariates — format_covariates","text":"","code":"format_covariates(   dat,   covariate_df,   bool_center = FALSE,   rescale_numeric_variables = NULL,   variables_enumerate_all = NULL )"},{"path":"https://linnykos.github.io/eSVD2/reference/format_covariates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Format covariates — format_covariates","text":"dat Dataset (either matrix dgCMatrix) \\(n\\) rows represent cells \\(p\\) columns represent genes. rows columns matrix named. covariate_df data.frame row represents cell, columns different categorical numerical variables wish adjust bool_center Boolean numerical variables centered around zero, default FALSE rescale_numeric_variables vector strings denoting column names covariate_df numerical wish rescale variables_enumerate_all NULL, allows control specifically factor variables covariate_df like split indicators. default, NULL, meaning factor variables split indicators","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/format_covariates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Format covariates — format_covariates","text":"matrix number rows dat","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/gandal_df.html","id":null,"dir":"Reference","previous_headings":"","what":"Gandal et al. results — gandal_df","title":"Gandal et al. results — gandal_df","text":"https://www.nature.com/articles/s41586-022-05377-7, Supplementary Data 3 (.e., 41586_2022_5377_MOESM5_ESM.xlsx)","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/gandal_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gandal et al. results — gandal_df","text":"","code":"gandal_df"},{"path":"https://linnykos.github.io/eSVD2/reference/gandal_df.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Gandal et al. results — gandal_df","text":"## `gandal_df` data frame 24836 rows (genes) 3 columns: external_gene_name Gene symbol WholeCortex_ASD_logFC Estimated log fold change WholeCortex_ASD_FDR FDR q-value","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/gandal_df.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Gandal et al. results — gandal_df","text":"<https://www.nature.com/articles/s41586-022-05377-7>","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/gandal_df.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Gandal et al. results — gandal_df","text":"","code":"if (FALSE) { # \\dontrun{ # How the data was loaded df <- openxlsx::read.xlsx(\"/Users/kevinlin/Downloads/41586_2022_5377_MOESM5_ESM.xlsx\",                           sheet = \"DEGene_Statistics\") gandal_df <- df[,c(\"external_gene_name\", \"WholeCortex_ASD_logFC\", \"WholeCortex_ASD_FDR\")] usethis::use_data(gandal_df) } # }"},{"path":"https://linnykos.github.io/eSVD2/reference/generate_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate data — generate_data","title":"Generate data — generate_data","text":"Generate data","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/generate_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate data — generate_data","text":"","code":"generate_data(   nat_mat,   family,   nuisance_param_vec = NA,   library_size_vec = 1,   tol = 0.001 )"},{"path":"https://linnykos.github.io/eSVD2/reference/generate_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate data — generate_data","text":"nat_mat \\(n\\times p\\) matrix natural parameters, \\(n\\) rows represent cells \\(p\\) columns represent genes. family character string, one \"gaussian\", \"exponential\", \"poisson\", \"neg_binom\", \"curved_gaussian\", \"bernoulli\". nuisance_param_vec Either NA single numeric length-\\(p\\) vector numerics representing nuisance parameters (family = \"neg_binom\" family = \"curved_gausian\"). required family %% c(\"neg_binom\", \"curved_gaussian\"). library_size_vec Either NA length-\\(n\\) vector numerics tol Small positive value determine smallest possible value output matrix, useful family = \"curved_gaussian\".","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/generate_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate data — generate_data","text":"generated data matrix","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/generate_null.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate null data — generate_null","title":"Generate null data — generate_null","text":"function allow much flexbility, meant primarily simple null simulations. , `n` (number cells) equal `cell_per_person*num_individuals`.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/generate_null.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate null data — generate_null","text":"","code":"generate_null(cell_per_person = 100, num_genes = 1000, num_individuals = 20)"},{"path":"https://linnykos.github.io/eSVD2/reference/generate_null.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate null data — generate_null","text":"cell_per_person number cells per individual num_genes number genes simulation num_individuals number individuals","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/generate_null.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate null data — generate_null","text":"list covariates (`matrix` `n` cells 4 columns, named `\"Intercept\"`, `\"Log_UMI\"`, `\"Sex\"`, `\"Age\"`, used `eSVD2::initialize_esvd`), df (`data.frame` `num_individuals` rows 5 columns, named named `\"Intercept\"`, `\"Log_UMI\"`, `\"Sex\"`, `\"Age\"`, `\"Individual\"`), metadata_individual (`matrix` `n` rows 1 column called `\"Individual\"` cell originates individual) nat_mat (`n` `p` `matrix` denoting natural parameter cell's gene expression), obs_mat (`n` `p` `dgCMatrix` denoting observed count cell's gene expression),","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/housekeeping_df.html","id":null,"dir":"Reference","previous_headings":"","what":"Hounkpe et al. housekeeping genes — housekeeping_df","title":"Hounkpe et al. housekeeping genes — housekeeping_df","text":"https://academic.oup.com/nar/article/49/D1/D947/5871367#supplementary-data, gkaa609_Supplemental_Files, specifically, Supplementary_Table1.xlsx)","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/housekeeping_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hounkpe et al. housekeeping genes — housekeeping_df","text":"","code":"housekeeping_df"},{"path":"https://linnykos.github.io/eSVD2/reference/housekeeping_df.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Hounkpe et al. housekeeping genes — housekeeping_df","text":"## `housekeeping_df` data frame 1003 rows (genes) 1 column: Gene Gene name","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/housekeeping_df.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Hounkpe et al. housekeeping genes — housekeeping_df","text":"<https://academic.oup.com/nar/article/49/D1/D947/5871367>","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/housekeeping_df.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Hounkpe et al. housekeeping genes — housekeeping_df","text":"","code":"if (FALSE) { # \\dontrun{ # How the data was loaded df <- openxlsx::read.xlsx(\"Supplementary_Table1.xlsx\", sheet = \"Gene Model\") colnames(df) <- df[1,1] housekeeping_df <- df[-1,,drop = FALSE] usethis::use_data(housekeeping_df) } # }"},{"path":"https://linnykos.github.io/eSVD2/reference/initialize_esvd.html","id":null,"dir":"Reference","previous_headings":"","what":"Initialize eSVD — initialize_esvd","title":"Initialize eSVD — initialize_esvd","text":"gene, function estimates two ridge-regression penalized GLMs (using Poisson model) – one using case_control_variable one without, sets coefficients well p-value (according deviance test) returned. p-value log10-scale.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/initialize_esvd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Initialize eSVD — initialize_esvd","text":"","code":"initialize_esvd(   dat,   covariates,   metadata_individual,   bool_intercept = F,   case_control_variable = NULL,   k = 30,   lambda = 0.01,   library_size_variable = \"Log_UMI\",   offset_variables = \"Log_UMI\",   metadata_case_control = NULL,   verbose = 0 )"},{"path":"https://linnykos.github.io/eSVD2/reference/initialize_esvd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Initialize eSVD — initialize_esvd","text":"dat Dataset (either matrix dgCMatrix) \\(n\\) rows represent cells \\(p\\) columns represent genes. rows columns matrix named. covariates matrix object \\(n\\) rows rownames dat columns represent different covariates. Notably, contain numerical columns (.e., categorical variables already split numerous indicator variables), columns covariates (strictly speaking) included eSVD matrix factorization model. metadata_individual factor vector length \\(n\\) denotes cell originates individual. bool_intercept Boolean whether intercept included covariate. case_control_variable string column name covariates depicts case-control status cell. Notably, binary variable 1 hard-coded describe case, 0 describe control. k Number latent dimensions. lambda Penalty mixed_effect_variables using glmnet::glmnet initialize coefficients. library_size_variable string variable name (must covariates) variable denotes sequenced (.e., observed) library size. offset_variables vector strings depicting column names covariate set coefficient 1 automatically (.e., estimation coefficient). metadata_case_control (Optional) vector length \\(n\\) values strictly 0 1 denotes cell cases controls. default, set NULL since code extract information covariates. verbose Integer","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/initialize_esvd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Initialize eSVD — initialize_esvd","text":"eSVD object elements dat, covariates, initial_Reg param","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/multtest.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform multiple-testing adjustment using Efron's empirical null — multtest","title":"Perform multiple-testing adjustment using Efron's empirical null — multtest","text":"Perform multiple-testing adjustment using Efron's empirical null","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/multtest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform multiple-testing adjustment using Efron's empirical null — multtest","text":"","code":"multtest(teststat_vec, observed_quantile = c(0.05, 0.95))"},{"path":"https://linnykos.github.io/eSVD2/reference/multtest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform multiple-testing adjustment using Efron's empirical null — multtest","text":"teststat_vec vector Gaussian-like test statistics observed_quantile quantiles teststat_vec used estimate null distribution","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/multtest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform multiple-testing adjustment using Efron's empirical null — multtest","text":"list fdr_vec, logpvalue_vec, method, null_mean, null_sd, pvalue_vec","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/opt_esvd.default.html","id":null,"dir":"Reference","previous_headings":"","what":"Optimize eSVD for matrices or sparse matrices. — opt_esvd.default","title":"Optimize eSVD for matrices or sparse matrices. — opt_esvd.default","text":"Optimize eSVD matrices sparse matrices.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/opt_esvd.default.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Optimize eSVD for matrices or sparse matrices. — opt_esvd.default","text":"","code":"# Default S3 method opt_esvd(   input_obj,   x_init,   y_init,   z_init = NULL,   covariates = NULL,   family = \"poisson\",   l2pen = 0.1,   library_multipler = rep(1, nrow(input_obj)),   max_iter = 100,   nuisance_vec = rep(NA, ncol(input_obj)),   offset_variables = NULL,   tol = 1e-06,   verbose = 0,   ... )"},{"path":"https://linnykos.github.io/eSVD2/reference/opt_esvd.default.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Optimize eSVD for matrices or sparse matrices. — opt_esvd.default","text":"input_obj Dataset (either matrix dgCMatrix) \\(n\\) rows represent cells \\(p\\) columns represent genes. rows columns matrix named. x_init Initial matrix cells' latent vectors \\(n\\) rows \\(k\\) columns. row names input_obj. y_init Initial matrix genes' latent vectors \\(p\\) rows \\(k\\) columns. row names column names input_obj. z_init Initial matrix genes' coefficient vectors \\(p\\) rows ncol(covariates) columns. row names column names input_obj, column names covariates. covariates matrix object \\(n\\) rows rownames input_obj columns represent different covariates. Notably, contain numerical columns (.e., categorical variables already split numerous indicator variables). family String among \"gaussian\", \"curved_gaussian\", \"exponential\", \"poisson\", \"neg_binom\", \"neg_binom2\", \"bernoulli\". Notably, exception \"neg_binom2\", families parameterized eSVD fitting dot product canonical parameter expoential-family distributions. \"neg_binom2\", dot product log-mean distribution (.e., similar canonical parameterization Poisson family). l2pen Small positive number amount penalization cells' genes' latent vectors well coefficients. library_multipler Vector positive numerics length \\(n\\). multiplier variance cell 's entries mean cell 's entries times square-root cell 's value library_multipler (entry-wise). used alternative interpretation library-size affects cell's gene expression (instead using library size covariate regressed ). max_iter Positive integer number iterations. nuisance_vec Vector non-negative numerics (NA's) length \\(p\\), representing gene's nuisance parameter using exponential-family distribution requires one. used family  \"curved_gaussian\" \"neg_binom\" \"neg_binom2\". offset_variables vector strings depicting column names input_obj$covariate treated offset optimization (.e., coefficients change throughout optimization). tol Small positive number differentiate zero non-zero. verbose Integer ... Additional parameters","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/opt_esvd.default.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Optimize eSVD for matrices or sparse matrices. — opt_esvd.default","text":"list elements x_mat, y_mat, z_mat, library_multiplier, loss, nuisance_vec param.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/opt_esvd.eSVD.html","id":null,"dir":"Reference","previous_headings":"","what":"Optimize eSVD for eSVD objects — opt_esvd.eSVD","title":"Optimize eSVD for eSVD objects — opt_esvd.eSVD","text":"Optimize eSVD eSVD objects","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/opt_esvd.eSVD.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Optimize eSVD for eSVD objects — opt_esvd.eSVD","text":"","code":"# S3 method for class 'eSVD' opt_esvd(   input_obj,   fit_name = \"fit_First\",   fit_previous = \"fit_Init\",   l2pen = 0.1,   max_iter = 100,   offset_variables = NULL,   tol = 1e-06,   verbose = 0,   ... )"},{"path":"https://linnykos.github.io/eSVD2/reference/opt_esvd.eSVD.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Optimize eSVD for eSVD objects — opt_esvd.eSVD","text":"input_obj eSVD object outputed apply_initial_threshold. fit_name String name become current fit storing results input_obj. fit_previous String name previous fit function grab initialization values . l2pen Small positive number amount penalization cells' genes' latent vectors well coefficients. max_iter Positive integer number iterations. offset_variables vector strings depicting column names input_obj$covariate treated offset optimization (.e., coefficients change throughout optimization). tol Small positive number differentiate zero non-zero. verbose Integer. ... Additional parameters.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/opt_esvd.eSVD.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Optimize eSVD for eSVD objects — opt_esvd.eSVD","text":"eSVD object added elements name whatever fit_name set .","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/opt_esvd.html","id":null,"dir":"Reference","previous_headings":"","what":"Optimize eSVD — opt_esvd","title":"Optimize eSVD — opt_esvd","text":"Generic function interface","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/opt_esvd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Optimize eSVD — opt_esvd","text":"","code":"opt_esvd(input_obj, ...)"},{"path":"https://linnykos.github.io/eSVD2/reference/opt_esvd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Optimize eSVD — opt_esvd","text":"input_obj Main object ... Additional parameters","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/opt_esvd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Optimize eSVD — opt_esvd","text":"Output dependent class input_obj","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/opt_x.html","id":null,"dir":"Reference","previous_headings":"","what":"Optimize X given C, Y and Z — opt_x","title":"Optimize X given C, Y and Z — opt_x","text":"Optimize X given C, Y Z","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/opt_x.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Optimize X given C, Y and Z — opt_x","text":"","code":"opt_x(   XC_init,   YZ,   k,   loader,   family,   s,   gamma,   l2penx,   verbose = 0,   inplace = FALSE,   ... )"},{"path":"https://linnykos.github.io/eSVD2/reference/opt_x.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Optimize X given C, Y and Z — opt_x","text":"XC_init Initial value `[X C]` matrix, X [n x k], C [n x r] YZ `[Y Z]` matrix, Y [p x k], Z [p x r] k Number columns X Y loader data loader, typically returned data_loader() family family object, typically returned esvd_family() s library size vector, [n x 1] gamma nuisance parameter vector, [p x 1] l2penx l2 penalty parameter X, scalar verbose Verbosity parameter inplace Whether input XC_init modified returned ... Additional parameters","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/opt_yz.html","id":null,"dir":"Reference","previous_headings":"","what":"Optimize Y and Z given X and C — opt_yz","title":"Optimize Y and Z given X and C — opt_yz","text":"Optimize Y Z given X C","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/opt_yz.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Optimize Y and Z given X and C — opt_yz","text":"","code":"opt_yz(   YZ_init,   XC,   k,   fixed_cols,   loader,   family,   s,   gamma,   l2peny,   l2penz,   verbose = 0,   inplace = FALSE,   ... )"},{"path":"https://linnykos.github.io/eSVD2/reference/opt_yz.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Optimize Y and Z given X and C — opt_yz","text":"YZ_init Initial value `[Y Z]` matrix, Y [p x k], Z [p x r] XC `[X C]` matrix, X [n x k], C [n x r] k Number columns X Y fixed_cols columns YZ need fixed loader data loader, typically returned data_loader() family family object, typically returned esvd_family() s library size vector, [n x 1] gamma nuisance parameter vector, [p x 1] l2peny l2 penalty parameter Y, scalar l2penz l2 penalty parameter Z, scalar verbose Verbosity parameter inplace Whether input XC_init modified returned ... Additional parameters","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/print.esvd_data_loader.html","id":null,"dir":"Reference","previous_headings":"","what":"Internal data loader function — print.esvd_data_loader","title":"Internal data loader function — print.esvd_data_loader","text":"Internal data loader function","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/print.esvd_data_loader.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Internal data loader function — print.esvd_data_loader","text":"","code":"# S3 method for class 'esvd_data_loader' print(x, ...)"},{"path":"https://linnykos.github.io/eSVD2/reference/print.esvd_data_loader.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Internal data loader function — print.esvd_data_loader","text":"x object ... additional arguments","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/print.esvd_data_loader.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Internal data loader function — print.esvd_data_loader","text":"description","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/reparameterization_esvd_covariates.html","id":null,"dir":"Reference","previous_headings":"","what":"Reparameterize eSVD object — reparameterization_esvd_covariates","title":"Reparameterize eSVD object — reparameterization_esvd_covariates","text":"Reparameterize eSVD object","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/reparameterization_esvd_covariates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Reparameterize eSVD object — reparameterization_esvd_covariates","text":"","code":"reparameterization_esvd_covariates(   input_obj,   fit_name,   omitted_variables = NULL,   verbose = 0 )"},{"path":"https://linnykos.github.io/eSVD2/reference/reparameterization_esvd_covariates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Reparameterize eSVD object — reparameterization_esvd_covariates","text":"input_obj eSVD object, either initialize_esvd() opt_esvd() fit_name name fit input_obj wish reparameterize. names(input_obj) omitted_variables Either NULL (default) variables input_obj$covariates reparameterized verbose Integer.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/reparameterization_esvd_covariates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Reparameterize eSVD object — reparameterization_esvd_covariates","text":"eSVD object adjusting fit fit_name.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/sfari_df.html","id":null,"dir":"Reference","previous_headings":"","what":"SFARI genes — sfari_df","title":"SFARI genes — sfari_df","text":"https://gene.sfari.org/database/human-gene/, clicking \"Download dataset\", accessed June 15, 2024","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/sfari_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"SFARI genes — sfari_df","text":"","code":"sfari_df"},{"path":"https://linnykos.github.io/eSVD2/reference/sfari_df.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"SFARI genes — sfari_df","text":"## `sfari_df` data frame 1176 rows (genes) 10 columns: status See website details gene.symbol Gene symbol gene.name Full gene name ensembl.id Gene ID chromosome Chromosome gene genetic.category See website details gene.score See website details syndromic See website details eagle See website details number..reports See website details","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/sfari_df.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"SFARI genes — sfari_df","text":"<https://www.science.org/doi/10.1126/science.aav8130>","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/sfari_df.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"SFARI genes — sfari_df","text":"","code":"if (FALSE) { # \\dontrun{ # How the data was loaded sfari_df <- read.csv(\"SFARI-Gene_genes_03-28-2024release_06-16-2024export.csv\") usethis::use_data(sfari_df) } # }"},{"path":"https://linnykos.github.io/eSVD2/reference/velmeshev_gene_df.html","id":null,"dir":"Reference","previous_headings":"","what":"Velmeshev et al. DEGs — velmeshev_gene_df","title":"Velmeshev et al. DEGs — velmeshev_gene_df","text":"https://www.science.org/doi/10.1126/science.aav8130, data supplement S4 (.e., aav8130_data-s4.xls)","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/velmeshev_gene_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Velmeshev et al. DEGs — velmeshev_gene_df","text":"","code":"velmeshev_gene_df"},{"path":"https://linnykos.github.io/eSVD2/reference/velmeshev_gene_df.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Velmeshev et al. DEGs — velmeshev_gene_df","text":"## `velmeshev_gene_df` data frame 692 rows (genes) 14 columns: Cell type Cell type DEG gene ID ENSG gene ID Gene name Gene name Gene biotype Biotype Fold change See original paper details Sample fold change See original paper details q value See original paper details correlation (bulk mRNA/bulkized nuclear RNA) See original paper details Epilepsy DEG boolean gene group boolean SFARI gene boolean Satterstrom boolean Sanders boolean cell type-specific expression boolean","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/velmeshev_gene_df.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Velmeshev et al. DEGs — velmeshev_gene_df","text":"<https://www.science.org/doi/10.1126/science.aav8130>","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/velmeshev_gene_df.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Velmeshev et al. DEGs — velmeshev_gene_df","text":"","code":"if (FALSE) { # \\dontrun{ # How the data was loaded tib <- readxl::read_xls(\"aav8130_data-s4.xls\", sheet = \"ASD_DEGs\") velmeshev_gene_df <- as.data.frame(tib) usethis::use_data(velmeshev_gene_df) } # }"}]
