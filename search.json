[{"path":"https://linnykos.github.io/eSVD2/articles/eSVD2.html","id":"purpose","dir":"Articles","previous_headings":"","what":"Purpose","title":"eSVD-DE Overview","text":"simulations meant portable, toy-examples eSVD2, intent demonstrate installation eSVD2 successful. successful installation eSVD2 required . See last section README system/package dependencies used creating simulations. simulations complete less 2 minutes.","code":""},{"path":"https://linnykos.github.io/eSVD2/articles/eSVD2.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"eSVD-DE Overview","text":"Broadly speaking, eSVD-DE (name method, implemented eSVD2 package) pipeline 6 different function calls. procedure starts primarily 3 inputs, dat, either matrix dgCMatrix, n rows (n cells) p columns (p genes). advise making sure row/column either matrix non-zero variance prior using pipeline. covariates, matrix n rows rownames dat columns represent different covariates Notably, contain numerical columns (.e., categorical variables already split numerous indicator variables), columns covariates (strictly speaking) included eSVD matrix factorization model. metadata_individual, factor vector length n denotes cell originates individual.","code":"library(eSVD2) library(Seurat)"},{"path":"https://linnykos.github.io/eSVD2/articles/eSVD2.html","id":"simulating-data","dir":"Articles","previous_headings":"","what":"Simulating data","title":"eSVD-DE Overview","text":"create simple dataset differentially expressed genes via eSVD2::generate_null() function. Seurat also installed, can run following lines well,  separation case control cells purely determined individual covariates Age Sex, case-control status.","code":"set.seed(10) res <- eSVD2::generate_null() covariates <- res$covariates metadata_individual <- res$metadata_individual obs_mat <- res$obs_mat set.seed(10) meta_data <- data.frame(covariates[, c(\"CC\", \"Sex\", \"Age\")]) meta_data$Individual <- metadata_individual seurat_obj <- Seurat::CreateSeuratObject(counts = Matrix::t(obs_mat), meta.data = meta_data) Seurat::VariableFeatures(seurat_obj) <- rownames(seurat_obj) seurat_obj <- Seurat::NormalizeData(seurat_obj) seurat_obj <- Seurat::ScaleData(seurat_obj) seurat_obj <- Seurat::RunPCA(seurat_obj, verbose = F) seurat_obj <- Seurat::RunUMAP(seurat_obj, dims = 1:5)  Seurat::DimPlot(seurat_obj, reduction = \"umap\", group.by = \"CC\")"},{"path":"https://linnykos.github.io/eSVD2/articles/eSVD2.html","id":"using-esvd-de","dir":"Articles","previous_headings":"","what":"Using eSVD-DE","title":"eSVD-DE Overview","text":"Step 1 (Initializing eSVD object): First, initialize object class eSVD, call eSVD_obj. done using eSVD2::initialize_esvd() function. following operations use eSVD_obj calculations usage method. pass inputs dat, covariates, metadata_individual. Notice eSVD2::initialize_esvd() (later, eSVD2::opt_esvd()) always call eSVD2::reparameterization_esvd_covariates() ensure fit remains identifiable. typically looks like following. Step 2 (Fitting eSVD object): now fit eSVD. Typically, recommend fitting twice (.e., calling eSVD2::opt_esvd() twice) due non-convex nature objective function. first call eSVD2::opt_esvd(), hold coefficients covariates aside case-control covariate (, denoted \"CC\" remove muhc case-control covariate effect possible. , second call eSVD2::opt_esvd(), allow coefficients optimized. Step 3 (Estimating nuisance (.e., -dispersion) parameters): fitting eSVD, need estimate nuisance parameters. Since modeling data via negative binomial, nuisance parameter -dispersion parameter. done via eSVD2::estimate_nuisance() function. Step 4 (Computing posterior): -disperison parameter estimated, now ready compute posterior mean variance cell’s gene expression value. posterior distribution balance fitted eSVD denoised value covariate-adjusted library size. step ensures even though pooled genes denoise single-cell expression matrix, later inflate Type-1 error. done via eSVD2::compute_posterior() function. Step 5 (Computing test statistics): Now can compute test statistics using eSVD2::compute_test_statistic() function. Step 6 (Computing p-values): Lastly, can compute p-values via eSVD2::compute_pvalue() function. visualize p-values, can plot theoretical quantiles observed quantiles. see despite UMAP showing strong differences case control cells, p-values uniformly distributed. shows inflate Type-1 error.","code":"set.seed(10) eSVD_obj <- eSVD2::initialize_esvd(   dat = obs_mat,   covariates = covariates,   case_control_variable = \"CC\",   bool_intercept = T,   k = 5,   lambda = 0.1,   metadata_individual = metadata_individual,   verbose = 0 ) eSVD_obj <- eSVD2::reparameterization_esvd_covariates(   input_obj = eSVD_obj,   fit_name = \"fit_Init\",   omitted_variables = \"Log_UMI\" )  names(eSVD_obj) #> [1] \"dat\"          \"covariates\"   \"param\"        \"fit_Init\"     \"latest_Fit\"   #> [6] \"case_control\" \"individual\" set.seed(10) eSVD_obj <- eSVD2::opt_esvd(   input_obj = eSVD_obj,   l2pen = 0.1,   max_iter = 100,   offset_variables = setdiff(colnames(eSVD_obj$covariates), \"CC\"),   tol = 1e-6,   verbose = 0,   fit_name = \"fit_First\",   fit_previous = \"fit_Init\" ) eSVD_obj <- eSVD2::reparameterization_esvd_covariates(   input_obj = eSVD_obj,   fit_name = \"fit_First\",   omitted_variables = \"Log_UMI\" )  set.seed(10) eSVD_obj <- eSVD2::opt_esvd(   input_obj = eSVD_obj,   l2pen = 0.1,   max_iter = 100,   offset_variables = NULL,   tol = 1e-6,   verbose = 0,   fit_name = \"fit_Second\",   fit_previous = \"fit_First\" )  eSVD_obj <- eSVD2::reparameterization_esvd_covariates(   input_obj = eSVD_obj,   fit_name = \"fit_Second\",   omitted_variables = NULL )  names(eSVD_obj) #> [1] \"dat\"          \"covariates\"   \"param\"        \"fit_Init\"     \"latest_Fit\"   #> [6] \"case_control\" \"individual\"   \"fit_First\"    \"fit_Second\" set.seed(10) eSVD_obj <- eSVD2::estimate_nuisance(   input_obj = eSVD_obj,   bool_covariates_as_library = TRUE,   bool_library_includes_interept = TRUE,   bool_use_log = FALSE,   min_val = 1e-4,   verbose = 0 )  names(eSVD_obj) #> [1] \"dat\"          \"covariates\"   \"param\"        \"fit_Init\"     \"latest_Fit\"   #> [6] \"case_control\" \"individual\"   \"fit_First\"    \"fit_Second\" set.seed(10) eSVD_obj <- eSVD2::compute_posterior(   input_obj = eSVD_obj,   bool_adjust_covariates = FALSE,   alpha_max = 100,   bool_covariates_as_library = TRUE,   bool_stabilize_underdispersion = TRUE,   library_min = 1,   pseudocount = 0 )  names(eSVD_obj) #> [1] \"dat\"          \"covariates\"   \"param\"        \"fit_Init\"     \"latest_Fit\"   #> [6] \"case_control\" \"individual\"   \"fit_First\"    \"fit_Second\" set.seed(10) eSVD_obj <- eSVD2::compute_test_statistic(input_obj = eSVD_obj, verbose = 0)  names(eSVD_obj) #>  [1] \"dat\"          \"covariates\"   \"param\"        \"fit_Init\"     \"latest_Fit\"   #>  [6] \"case_control\" \"individual\"   \"fit_First\"    \"fit_Second\"   \"teststat_vec\" #> [11] \"case_mean\"    \"control_mean\" set.seed(10) eSVD_obj <- eSVD2::compute_pvalue(input_obj = eSVD_obj)  names(eSVD_obj) #>  [1] \"dat\"          \"covariates\"   \"param\"        \"fit_Init\"     \"latest_Fit\"   #>  [6] \"case_control\" \"individual\"   \"fit_First\"    \"fit_Second\"   \"teststat_vec\" #> [11] \"case_mean\"    \"control_mean\" \"pvalue_list\" pvalue_vec <- 10 ^ (-eSVD_obj$pvalue_list$log10pvalue) graphics::plot(   x = sort(pvalue_vec),   y = seq(0, 1, length.out = length(pvalue_vec)),   asp = TRUE,   pch = 16,   xlab = \"Observed quantile\",   ylab = \"Theoretical quantile\" ) graphics::lines(   x = c(0, 1),   y = c(0, 1),   col = \"red\",   lty = 2,   lwd = 2 )"},{"path":"https://linnykos.github.io/eSVD2/articles/eSVD2.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"eSVD-DE Overview","text":"following shows suggested package versions developer (GitHub username: linnykos) used developing eSVD2 package.","code":"> devtools::session_info() ─ Session info ────────────────────  setting  value  version  R version 4.3.2 (2023-10-31)  os       macOS Sonoma 14.2.1  system   aarch64, darwin20  ui       RStudio  language (EN)  collate  en_US.UTF-8  ctype    en_US.UTF-8  tz       America/Los_Angeles  date     2024-06-15  rstudio  2024.04.1+748 Chocolate Cosmos (desktop)  pandoc   3.1.11 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/tools/aarch64/ (via rmarkdown)  ─ Packages ────────────────────────  package          * version    date (UTC) lib source  abind              1.4-5      2016-07-21 [1] CRAN (R 4.3.0)  cachem             1.0.8      2023-05-01 [1] CRAN (R 4.3.0)  cli                3.6.2      2023-12-11 [1] CRAN (R 4.3.1)  cluster            2.1.6      2023-12-01 [1] CRAN (R 4.3.1)  codetools          0.2-20     2024-03-31 [1] CRAN (R 4.3.1)  colorspace         2.1-0      2023-01-23 [1] CRAN (R 4.3.0)  cowplot            1.1.3      2024-01-22 [1] CRAN (R 4.3.1)  data.table         1.15.4     2024-03-30 [1] CRAN (R 4.3.1)  deldir             2.0-4      2024-02-28 [1] CRAN (R 4.3.1)  devtools           2.4.5      2022-10-11 [1] CRAN (R 4.3.0)  digest             0.6.35     2024-03-11 [1] CRAN (R 4.3.1)  dotCall64          1.1-1      2023-11-28 [1] CRAN (R 4.3.1)  dplyr              1.1.4      2023-11-17 [1] CRAN (R 4.3.1)  ellipsis           0.3.2      2021-04-29 [1] CRAN (R 4.3.0)  eSVD2            * 0.0.1.0000 2024-06-16 [1] local  evaluate           0.23       2023-11-01 [1] CRAN (R 4.3.1)  fansi              1.0.6      2023-12-08 [1] CRAN (R 4.3.1)  fastDummies        1.7.3      2023-07-06 [1] CRAN (R 4.3.0)  fastmap            1.1.1      2023-02-24 [1] CRAN (R 4.3.0)  fitdistrplus       1.1-11     2023-04-25 [1] CRAN (R 4.3.0)  fs                 1.6.3      2023-07-20 [1] CRAN (R 4.3.0)  future             1.33.2     2024-03-26 [1] CRAN (R 4.3.1)  future.apply       1.11.2     2024-03-28 [1] CRAN (R 4.3.1)  generics           0.1.3      2022-07-05 [1] CRAN (R 4.3.0)  ggplot2            3.5.0      2024-02-23 [1] CRAN (R 4.3.1)  ggrepel            0.9.5      2024-01-10 [1] CRAN (R 4.3.1)  ggridges           0.5.6      2024-01-23 [1] CRAN (R 4.3.1)  globals            0.16.3     2024-03-08 [1] CRAN (R 4.3.1)  glue               1.7.0      2024-01-09 [1] CRAN (R 4.3.1)  goftest            1.2-3      2021-10-07 [1] CRAN (R 4.3.0)  gridExtra          2.3        2017-09-09 [1] CRAN (R 4.3.0)  gtable             0.3.4      2023-08-21 [1] CRAN (R 4.3.0)  htmltools          0.5.8.1    2024-04-04 [1] CRAN (R 4.3.1)  htmlwidgets        1.6.4      2023-12-06 [1] CRAN (R 4.3.1)  httpuv             1.6.15     2024-03-26 [1] CRAN (R 4.3.1)  httr               1.4.7      2023-08-15 [1] CRAN (R 4.3.0)  ica                1.0-3      2022-07-08 [1] CRAN (R 4.3.0)  igraph             2.0.3      2024-03-13 [1] CRAN (R 4.3.1)  irlba              2.3.5.1    2022-10-03 [1] CRAN (R 4.3.2)  jsonlite           1.8.8      2023-12-04 [1] CRAN (R 4.3.1)  KernSmooth         2.23-22    2023-07-10 [1] CRAN (R 4.3.0)  knitr              1.45       2023-10-30 [1] CRAN (R 4.3.1)  later              1.3.2      2023-12-06 [1] CRAN (R 4.3.1)  lattice            0.22-6     2024-03-20 [1] CRAN (R 4.3.1)  lazyeval           0.2.2      2019-03-15 [1] CRAN (R 4.3.0)  leiden             0.4.3.1    2023-11-17 [1] CRAN (R 4.3.1)  lifecycle          1.0.4      2023-11-07 [1] CRAN (R 4.3.1)  listenv            0.9.1      2024-01-29 [1] CRAN (R 4.3.1)  lmtest             0.9-40     2022-03-21 [1] CRAN (R 4.3.0)  magrittr           2.0.3      2022-03-30 [1] CRAN (R 4.3.0)  MASS               7.3-60.0.1 2024-01-13 [1] CRAN (R 4.3.1)  Matrix             1.6-5      2024-01-11 [1] CRAN (R 4.3.2)  matrixStats        1.3.0      2024-04-11 [1] CRAN (R 4.3.1)  memoise            2.0.1      2021-11-26 [1] CRAN (R 4.3.0)  mime               0.12       2021-09-28 [1] CRAN (R 4.3.0)  miniUI             0.1.1.1    2018-05-18 [1] CRAN (R 4.3.0)  munsell            0.5.1      2024-04-01 [1] CRAN (R 4.3.1)  nlme               3.1-164    2023-11-27 [1] CRAN (R 4.3.1)  parallelly         1.37.1     2024-02-29 [1] CRAN (R 4.3.1)  patchwork          1.2.0      2024-01-08 [1] CRAN (R 4.3.1)  pbapply            1.7-2      2023-06-27 [1] CRAN (R 4.3.0)  pillar             1.9.0      2023-03-22 [1] CRAN (R 4.3.0)  pkgbuild           1.4.4      2024-03-17 [1] CRAN (R 4.3.1)  pkgconfig          2.0.3      2019-09-22 [1] CRAN (R 4.3.0)  pkgload            1.3.4      2024-01-16 [1] CRAN (R 4.3.1)  plotly             4.10.4     2024-01-13 [1] CRAN (R 4.3.1)  plyr               1.8.9      2023-10-02 [1] CRAN (R 4.3.1)  png                0.1-8      2022-11-29 [1] CRAN (R 4.3.0)  polyclip           1.10-6     2023-09-27 [1] CRAN (R 4.3.1)  profvis            0.3.8      2023-05-02 [1] CRAN (R 4.3.0)  progressr          0.14.0     2023-08-10 [1] CRAN (R 4.3.0)  promises           1.3.0      2024-04-05 [1] CRAN (R 4.3.1)  purrr              1.0.2      2023-08-10 [1] CRAN (R 4.3.0)  R6                 2.5.1      2021-08-19 [1] CRAN (R 4.3.0)  RANN               2.6.1      2019-01-08 [1] CRAN (R 4.3.0)  RColorBrewer       1.1-3      2022-04-03 [1] CRAN (R 4.3.0)  Rcpp             * 1.0.12     2024-01-09 [1] CRAN (R 4.3.1)  RcppAnnoy          0.0.22     2024-01-23 [1] CRAN (R 4.3.1)  RcppHNSW           0.6.0      2024-02-04 [1] CRAN (R 4.3.1)  remotes            2.5.0      2024-03-17 [1] CRAN (R 4.3.1)  reshape2           1.4.4      2020-04-09 [1] CRAN (R 4.3.0)  reticulate         1.35.0     2024-01-31 [1] CRAN (R 4.3.1)  rlang              1.1.3      2024-01-10 [1] CRAN (R 4.3.1)  rmarkdown          2.26       2024-03-05 [1] CRAN (R 4.3.1)  ROCR               1.0-11     2020-05-02 [1] CRAN (R 4.3.0)  RSpectra           0.16-1     2022-04-24 [1] CRAN (R 4.3.0)  rstudioapi         0.16.0     2024-03-24 [1] CRAN (R 4.3.1)  Rtsne              0.17       2023-12-07 [1] CRAN (R 4.3.1)  scales             1.3.0      2023-11-28 [1] CRAN (R 4.3.1)  scattermore        1.2        2023-06-12 [1] CRAN (R 4.3.0)  sctransform        0.4.1      2023-10-19 [1] CRAN (R 4.3.1)  sessioninfo        1.2.2      2021-12-06 [1] CRAN (R 4.3.0)  Seurat           * 5.0.3      2024-03-18 [1] CRAN (R 4.3.1)  SeuratObject     * 5.0.1      2023-11-17 [1] CRAN (R 4.3.1)  shiny              1.8.1.1    2024-04-02 [1] CRAN (R 4.3.1)  sp               * 2.1-3      2024-01-30 [1] CRAN (R 4.3.1)  spam               2.10-0     2023-10-23 [1] CRAN (R 4.3.1)  spatstat.data      3.0-4      2024-01-15 [1] CRAN (R 4.3.1)  spatstat.explore   3.2-7      2024-03-21 [1] CRAN (R 4.3.1)  spatstat.geom      3.2-9      2024-02-28 [1] CRAN (R 4.3.1)  spatstat.random    3.2-3      2024-02-29 [1] CRAN (R 4.3.1)  spatstat.sparse    3.0-3      2023-10-24 [1] CRAN (R 4.3.1)  spatstat.utils     3.0-4      2023-10-24 [1] CRAN (R 4.3.1)  stringi            1.8.3      2023-12-11 [1] CRAN (R 4.3.1)  stringr            1.5.1      2023-11-14 [1] CRAN (R 4.3.1)  survival           3.5-8      2024-02-14 [1] CRAN (R 4.3.1)  tensor             1.5        2012-05-05 [1] CRAN (R 4.3.0)  tibble             3.2.1      2023-03-20 [1] CRAN (R 4.3.0)  tidyr              1.3.1      2024-01-24 [1] CRAN (R 4.3.1)  tidyselect         1.2.1      2024-03-11 [1] CRAN (R 4.3.1)  urlchecker         1.0.1      2021-11-30 [1] CRAN (R 4.3.0)  usethis            2.2.3      2024-02-19 [1] CRAN (R 4.3.1)  utf8               1.2.4      2023-10-22 [1] CRAN (R 4.3.1)  uwot               0.1.16     2023-06-29 [1] CRAN (R 4.3.0)  vctrs              0.6.5      2023-12-01 [1] CRAN (R 4.3.1)  viridisLite        0.4.2      2023-05-02 [1] CRAN (R 4.3.0)  xfun               0.43       2024-03-25 [1] CRAN (R 4.3.1)  xtable             1.8-4      2019-04-21 [1] CRAN (R 4.3.0)  yaml               2.3.8      2023-12-11 [1] CRAN (R 4.3.1)  zoo                1.8-12     2023-04-13 [1] CRAN (R 4.3.0)"},{"path":"https://linnykos.github.io/eSVD2/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"First Last. Author, maintainer.","code":""},{"path":"https://linnykos.github.io/eSVD2/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Last F (2024). eSVD2: eSVD2. R package version 0.0.1.0000, https://linnykos.github.io/eSVD2/.","code":"@Manual{,   title = {eSVD2: eSVD2},   author = {First Last},   year = {2024},   note = {R package version 0.0.1.0000},   url = {https://linnykos.github.io/eSVD2/}, }"},{"path":"https://linnykos.github.io/eSVD2/reference/compute_posterior.default.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute posterior according to Gamma-Poisson model for matrices and sparse matrices. — compute_posterior.default","title":"Compute posterior according to Gamma-Poisson model for matrices and sparse matrices. — compute_posterior.default","text":"Compute posterior according Gamma-Poisson model matrices sparse matrices.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_posterior.default.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute posterior according to Gamma-Poisson model for matrices and sparse matrices. — compute_posterior.default","text":"","code":"# S3 method for default compute_posterior(   input_obj,   case_control_variable,   covariates,   esvd_res,   library_size_variable,   nuisance_vec,   alpha_max = 1000,   bool_adjust_covariates = F,   bool_covariates_as_library = T,   bool_library_includes_interept = T,   bool_return_components = F,   bool_stabilize_underdispersion = T,   library_min = 0.1,   nuisance_lower_quantile = 0.01,   pseudocount = 0,   ... )"},{"path":"https://linnykos.github.io/eSVD2/reference/compute_posterior.default.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute posterior according to Gamma-Poisson model for matrices and sparse matrices. — compute_posterior.default","text":"input_obj Dataset (either matrix dgCMatrix) \\(n\\) rows represent cells \\(p\\) columns represent genes. rows columns matrix named. case_control_variable string column name covariates depicts case-control status cell. Notably, binary variable 1 hard-coded describe case, 0 describe control. covariates matrix object \\(n\\) rows rownames dat columns represent different covariates. Notably, contain numerical columns (.e., categorical variables already split numerous indicator variables). esvd_res Output opt_esvd.default, notably elements x_mat, y_mat z_mat library_size_variable string variable name (must covariates) variable denotes sequenced (.e., observed) library size. nuisance_vec Vector non-negative numerics length ncol(input_obj), output estimate_nuisance.default. alpha_max Maximum value numerator computing posterior, default 1e3. bool_adjust_covariates Boolean adjust numerator posterior donor covariates, default FALSE. parameter experimental, yet encountered scenario useful set TRUE. bool_covariates_as_library Boolean include donor covariates effects adjusted library size, default TRUE. bool_library_includes_interept Boolean intercept term eSVD matrix factorization included calculation covariate-adjusted library size, default TRUE. bool_return_components Boolean return numerator denominator posterior terms well (matrices cell--gene matrices), default FALSE. bool_stabilize_underdispersion Boolean stabilize -dispersion parameter, specifically rescale -dispersions global mean -disperion less 1, default TRUE. library_min covariate-adjusted library size smaller value set value, default 0.1. nuisance_lower_quantile nuisance values smaller quantile set quantile. pseudocount additional count added count matrix, default 0. ... Additional parameters.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_posterior.default.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute posterior according to Gamma-Poisson model for matrices and sparse matrices. — compute_posterior.default","text":"list elements posterior_mean_mat posterior_var_mat","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_posterior.eSVD.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute posterior according to Gamma-Poisson model for eSVD object — compute_posterior.eSVD","title":"Compute posterior according to Gamma-Poisson model for eSVD object — compute_posterior.eSVD","text":"posterior computed based whatever input_obj$latest_Fit set .","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_posterior.eSVD.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute posterior according to Gamma-Poisson model for eSVD object — compute_posterior.eSVD","text":"","code":"# S3 method for eSVD compute_posterior(   input_obj,   alpha_max = 1000,   bool_adjust_covariates = F,   bool_covariates_as_library = T,   bool_return_components = F,   bool_stabilize_underdispersion = T,   library_min = 0.1,   nuisance_lower_quantile = 0.01,   pseudocount = 0,   ... )"},{"path":"https://linnykos.github.io/eSVD2/reference/compute_posterior.eSVD.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute posterior according to Gamma-Poisson model for eSVD object — compute_posterior.eSVD","text":"input_obj eSVD object outputed opt_esvd.eSVD. alpha_max Maximum value numerator computing posterior, default 1e3. bool_adjust_covariates Boolean adjust numerator posterior donor covariates, default FALSE. parameter experimental, yet encountered scenario useful set TRUE. bool_covariates_as_library Boolean include donor covariates effects adjusted library size, default TRUE bool_return_components Boolean return numerator denominator posterior terms well (matrices cell--gene matrices), default FALSE bool_stabilize_underdispersion Boolean stabilize -dispersion parameter, specifically rescale -dispersions global mean -disperion less 1, default TRUE library_min covariate-adjusted library size smaller value set value, default 0.1. nuisance_lower_quantile nuisance values smaller quantile set quantile, default 0.01 pseudocount additional count added count matrix, default 0. ... Additional parameters.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_posterior.eSVD.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute posterior according to Gamma-Poisson model for eSVD object — compute_posterior.eSVD","text":"eSVD object posterior_mean_mat posterior_var_mat appended list input_obj[[input_obj[[\"latest_Fit\"]]]].","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_posterior.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute posterior according to Gamma-Poisson model — compute_posterior","title":"Compute posterior according to Gamma-Poisson model — compute_posterior","text":"Generic function interface","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_posterior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute posterior according to Gamma-Poisson model — compute_posterior","text":"","code":"compute_posterior(input_obj, ...)"},{"path":"https://linnykos.github.io/eSVD2/reference/compute_posterior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute posterior according to Gamma-Poisson model — compute_posterior","text":"input_obj Main object ... Additional parameters","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_posterior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute posterior according to Gamma-Poisson model — compute_posterior","text":"Output dependent class input_obj","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_pvalue.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute p-values — compute_pvalue","title":"Compute p-values — compute_pvalue","text":"Compute p-values","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_pvalue.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute p-values — compute_pvalue","text":"","code":"compute_pvalue(input_obj, verbose = 0, ...)"},{"path":"https://linnykos.github.io/eSVD2/reference/compute_pvalue.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute p-values — compute_pvalue","text":"input_obj eSVD object outputed compute_test_statistic. verbose Integer. ... Additional parameters.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_pvalue.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute p-values — compute_pvalue","text":"eSVD object added element \"pvalue_list\"","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_test_statistic.default.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute test statistics for matrices — compute_test_statistic.default","title":"Compute test statistics for matrices — compute_test_statistic.default","text":"Compute test statistics matrices","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_test_statistic.default.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute test statistics for matrices — compute_test_statistic.default","text":"","code":"# S3 method for default compute_test_statistic(   input_obj,   posterior_var_mat,   case_individuals,   control_individuals,   individual_vec,   verbose = 0,   ... )"},{"path":"https://linnykos.github.io/eSVD2/reference/compute_test_statistic.default.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute test statistics for matrices — compute_test_statistic.default","text":"input_obj Posterior mean matrix (matrix) \\(n\\) rows represent cells \\(p\\) columns represent genes. rows columns matrix named. posterior_var_mat Posterior variance matrix (matrix) \\(n\\) rows represent cells \\(p\\) columns represent genes. rows columns matrix input_obj. case_individuals Vector strings representing individuals metadata[,covariate_individual] case individuals. control_individuals Vector strings representing individuals metadata[,covariate_individual] control individuals. individual_vec Vector strings length \\(n\\) (.e., number cells) denote cell originates individual. verbose Integer. ... Additional parameters.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_test_statistic.default.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute test statistics for matrices — compute_test_statistic.default","text":"vector test statistics length ncol(input_obj)","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_test_statistic.eSVD.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute test statistics for eSVD object — compute_test_statistic.eSVD","title":"Compute test statistics for eSVD object — compute_test_statistic.eSVD","text":"Compute test statistics eSVD object","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_test_statistic.eSVD.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute test statistics for eSVD object — compute_test_statistic.eSVD","text":"","code":"# S3 method for eSVD compute_test_statistic(input_obj, verbose = 0, ...)"},{"path":"https://linnykos.github.io/eSVD2/reference/compute_test_statistic.eSVD.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute test statistics for eSVD object — compute_test_statistic.eSVD","text":"input_obj eSVD object outputed compute_posterior.eSVD. verbose Integer. ... Additional parameters.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_test_statistic.eSVD.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute test statistics for eSVD object — compute_test_statistic.eSVD","text":"eSVD object added element \"teststat_vec\"","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_test_statistic.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute test statistics — compute_test_statistic","title":"Compute test statistics — compute_test_statistic","text":"Generic function interface","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_test_statistic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute test statistics — compute_test_statistic","text":"","code":"compute_test_statistic(input_obj, ...)"},{"path":"https://linnykos.github.io/eSVD2/reference/compute_test_statistic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute test statistics — compute_test_statistic","text":"input_obj Main object ... Additional parameters","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/compute_test_statistic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute test statistics — compute_test_statistic","text":"Output dependent class input_obj","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/data_loader.html","id":null,"dir":"Reference","previous_headings":"","what":"Internal data loader function — data_loader","title":"Internal data loader function — data_loader","text":"Internal data loader function","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/data_loader.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Internal data loader function — data_loader","text":"","code":"data_loader(mat)"},{"path":"https://linnykos.github.io/eSVD2/reference/data_loader.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Internal data loader function — data_loader","text":"mat matrix","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/data_loader.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Internal data loader function — data_loader","text":"pointer","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/dot-compute_df.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the degree of freedom — .compute_df","title":"Compute the degree of freedom — .compute_df","text":"intermediary function used compute_pvalue","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/dot-compute_df.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the degree of freedom — .compute_df","text":"","code":".compute_df(input_obj)"},{"path":"https://linnykos.github.io/eSVD2/reference/dot-compute_df.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the degree of freedom — .compute_df","text":"input_obj eSVD object outputed compute_test_statistic.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/dot-compute_df.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute the degree of freedom — .compute_df","text":"named vector degree--freedom values, one gene","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/dot-reparameterize.html","id":null,"dir":"Reference","previous_headings":"","what":"Function to reparameterize two matrices — .reparameterize","title":"Function to reparameterize two matrices — .reparameterize","text":"test","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/dot-reparameterize.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Function to reparameterize two matrices — .reparameterize","text":"","code":".reparameterize(x_mat, y_mat, equal_covariance)"},{"path":"https://linnykos.github.io/eSVD2/reference/dot-reparameterize.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Function to reparameterize two matrices — .reparameterize","text":"x_mat matrix dimension n k y_mat matrix dimension p k equal_covariance boolean","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/dot-reparameterize.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Function to reparameterize two matrices — .reparameterize","text":"list two matrices","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/dot-reparameterize.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Function to reparameterize two matrices — .reparameterize","text":"Designed output matrices dimension x_mat y_mat, linearly transformed x_mat %*% t(y_mat) preserved either x_mat %*% t(x_mat) diagonal equal y_mat %*% t(y_mat) (equal_covariance FALSE) x_mat %*% t(x_mat)/nrow(x_mat) diagonal equal y_mat %*% t(y_mat)/nrow(y_mat) (equal_covariance TRUE)","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/estimate_nuisance.default.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate nuisance values for matrix or sparse matrices. — estimate_nuisance.default","title":"Estimate nuisance values for matrix or sparse matrices. — estimate_nuisance.default","text":"Estimate nuisance values matrix sparse matrices.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/estimate_nuisance.default.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate nuisance values for matrix or sparse matrices. — estimate_nuisance.default","text":"","code":"# S3 method for default estimate_nuisance(   input_obj,   mean_mat,   library_mat,   bool_use_log = F,   min_val = 1e-04,   verbose = 0,   ... )"},{"path":"https://linnykos.github.io/eSVD2/reference/estimate_nuisance.default.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate nuisance values for matrix or sparse matrices. — estimate_nuisance.default","text":"input_obj Dataset (either matrix dgCMatrix) \\(n\\) rows represent cells \\(p\\) columns represent genes. rows columns matrix named. mean_mat matrix \\(n\\) rows \\(p\\) columns represents expected value entry. library_mat matrix \\(n\\) rows \\(p\\) columns represents library size entry. bool_use_log Boolean nuisance (.e., -dispersion) parameter estimated log scale, default FALSE. min_val Minimum value nuisance parameter. verbose Integer. ... Additional parameters.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/estimate_nuisance.default.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate nuisance values for matrix or sparse matrices. — estimate_nuisance.default","text":"Vector length \\(p\\)","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/estimate_nuisance.eSVD.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate nuisance values for eSVD objects (i.e., over-dispersion) — estimate_nuisance.eSVD","title":"Estimate nuisance values for eSVD objects (i.e., over-dispersion) — estimate_nuisance.eSVD","text":"Assumes Gamma-Poisson model mean variance proportionally related.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/estimate_nuisance.eSVD.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate nuisance values for eSVD objects (i.e., over-dispersion) — estimate_nuisance.eSVD","text":"","code":"# S3 method for eSVD estimate_nuisance(   input_obj,   bool_covariates_as_library = F,   bool_library_includes_interept = T,   bool_use_log = F,   min_val = 1e-04,   verbose = 0,   ... )"},{"path":"https://linnykos.github.io/eSVD2/reference/estimate_nuisance.eSVD.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate nuisance values for eSVD objects (i.e., over-dispersion) — estimate_nuisance.eSVD","text":"input_obj eSVD object outputed opt_esvd.eSVD. Specifically, nuisance parameters estimated based fit input_obj[[input_obj[[\"latest_Fit\"]]]]. bool_covariates_as_library Boolean adjust numerator posterior donor covariates, default FALSE. parameter experimental, yet encountered scenario useful set TRUE. bool_library_includes_interept Boolean intercept term eSVD matrix factorization included calculation covariate-adjusted library size, default TRUE. bool_use_log Boolean nuisance (.e., -dispersion) parameter estimated log scale, default FALSE. min_val Minimum value nuisance parameter. verbose Integer. ... Additional parameters.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/estimate_nuisance.eSVD.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate nuisance values for eSVD objects (i.e., over-dispersion) — estimate_nuisance.eSVD","text":"eSVD object nuisance_vec appended list input_obj[[input_obj[[\"latest_Fit\"]]]].","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/estimate_nuisance.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate nuisance values — estimate_nuisance","title":"Estimate nuisance values — estimate_nuisance","text":"Generic function interface","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/estimate_nuisance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate nuisance values — estimate_nuisance","text":"","code":"estimate_nuisance(input_obj, ...)"},{"path":"https://linnykos.github.io/eSVD2/reference/estimate_nuisance.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate nuisance values — estimate_nuisance","text":"input_obj Main object ... Additional parameters","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/estimate_nuisance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate nuisance values — estimate_nuisance","text":"Output dependent class input_obj","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/esvd_family.html","id":null,"dir":"Reference","previous_headings":"","what":"Internal Constructor for distribution family — esvd_family","title":"Internal Constructor for distribution family — esvd_family","text":"Internal Constructor distribution family","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/esvd_family.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Internal Constructor for distribution family — esvd_family","text":"","code":"esvd_family(family)"},{"path":"https://linnykos.github.io/eSVD2/reference/esvd_family.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Internal Constructor for distribution family — esvd_family","text":"family string","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/esvd_family.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Internal Constructor for distribution family — esvd_family","text":"object conversion functions","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/generate_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate data — generate_data","title":"Generate data — generate_data","text":"Generate data","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/generate_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate data — generate_data","text":"","code":"generate_data(   nat_mat,   family,   nuisance_param_vec = NA,   library_size_vec = 1,   tol = 0.001 )"},{"path":"https://linnykos.github.io/eSVD2/reference/generate_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate data — generate_data","text":"nat_mat \\(n\\times p\\) matrix natural parameters, \\(n\\) rows represent cells \\(p\\) columns represent genes. family character string, one \"gaussian\", \"exponential\", \"poisson\", \"neg_binom\", \"curved_gaussian\", \"bernoulli\". nuisance_param_vec Either NA single numeric length-\\(p\\) vector numerics representing nuisance parameters (family = \"neg_binom\" family = \"curved_gausian\"). required family %% c(\"neg_binom\", \"curved_gaussian\"). library_size_vec Either NA length-\\(n\\) vector numerics tol Small positive value determine smallest possible value output matrix, useful family = \"curved_gaussian\".","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/generate_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate data — generate_data","text":"generated data matrix","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/generate_null.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate null data — generate_null","title":"Generate null data — generate_null","text":"function allow much flexbility, meant primarily simple null simulations. , `n` (number cells) equal `cell_per_person*num_individuals`.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/generate_null.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate null data — generate_null","text":"","code":"generate_null(cell_per_person = 100, num_genes = 1000, num_individuals = 20)"},{"path":"https://linnykos.github.io/eSVD2/reference/generate_null.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate null data — generate_null","text":"cell_per_person number cells per individual num_genes number genes simulation num_individuals number individuals","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/generate_null.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate null data — generate_null","text":"list covariates (`matrix` `n` cells 4 columns, named `\"Intercept\"`, `\"Log_UMI\"`, `\"Sex\"`, `\"Age\"`, used `eSVD2::initialize_esvd`), df (`data.frame` `num_individuals` rows 5 columns, named named `\"Intercept\"`, `\"Log_UMI\"`, `\"Sex\"`, `\"Age\"`, `\"Individual\"`), metadata_individual (`matrix` `n` rows 1 column called `\"Individual\"` cell originates individual) nat_mat (`n` `p` `matrix` denoting natural parameter cell's gene expression), obs_mat (`n` `p` `dgCMatrix` denoting observed count cell's gene expression),","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/initialize_esvd.html","id":null,"dir":"Reference","previous_headings":"","what":"Initialize eSVD — initialize_esvd","title":"Initialize eSVD — initialize_esvd","text":"gene, function estimates two ridge-regression penalized GLMs (using Poisson model) -- one using case_control_variable one without, sets coefficients well p-value (according deviance test) returned. p-value log10-scale.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/initialize_esvd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Initialize eSVD — initialize_esvd","text":"","code":"initialize_esvd(   dat,   covariates,   metadata_individual,   bool_intercept = F,   case_control_variable = NULL,   k = 30,   lambda = 0.01,   library_size_variable = \"Log_UMI\",   offset_variables = \"Log_UMI\",   metadata_case_control = NULL,   verbose = 0 )"},{"path":"https://linnykos.github.io/eSVD2/reference/initialize_esvd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Initialize eSVD — initialize_esvd","text":"dat Dataset (either matrix dgCMatrix) \\(n\\) rows represent cells \\(p\\) columns represent genes. rows columns matrix named. covariates matrix object \\(n\\) rows rownames dat columns represent different covariates. Notably, contain numerical columns (.e., categorical variables already split numerous indicator variables), columns covariates (strictly speaking) included eSVD matrix factorization model. metadata_individual factor vector length \\(n\\) denotes cell originates individual. bool_intercept Boolean whether intercept included covariate. case_control_variable string column name covariates depicts case-control status cell. Notably, binary variable 1 hard-coded describe case, 0 describe control. k Number latent dimensions. lambda Penalty mixed_effect_variables using glmnet::glmnet initialize coefficients. library_size_variable string variable name (must covariates) variable denotes sequenced (.e., observed) library size. offset_variables vector strings depicting column names covariate set coefficient 1 automatically (.e., estimation coefficient). metadata_case_control (Optional) vector length \\(n\\) values strictly 0 1 denotes cell cases controls. default, set NULL since code extract information covariates. verbose Integer","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/initialize_esvd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Initialize eSVD — initialize_esvd","text":"eSVD object elements dat, covariates, initial_Reg param","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/multtest.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform multiple-testing adjustment using Efron's empirical null — multtest","title":"Perform multiple-testing adjustment using Efron's empirical null — multtest","text":"Perform multiple-testing adjustment using Efron's empirical null","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/multtest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform multiple-testing adjustment using Efron's empirical null — multtest","text":"","code":"multtest(teststat_vec, observed_quantile = c(0.05, 0.95))"},{"path":"https://linnykos.github.io/eSVD2/reference/multtest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform multiple-testing adjustment using Efron's empirical null — multtest","text":"teststat_vec vector Gaussian-like test statistics observed_quantile quantiles teststat_vec used estimate null distribution","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/multtest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform multiple-testing adjustment using Efron's empirical null — multtest","text":"list fdr_vec, logpvalue_vec, method, null_mean, null_sd, pvalue_vec","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/opt_esvd.default.html","id":null,"dir":"Reference","previous_headings":"","what":"Optimize eSVD for matrices or sparse matrices. — opt_esvd.default","title":"Optimize eSVD for matrices or sparse matrices. — opt_esvd.default","text":"Optimize eSVD matrices sparse matrices.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/opt_esvd.default.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Optimize eSVD for matrices or sparse matrices. — opt_esvd.default","text":"","code":"# S3 method for default opt_esvd(   input_obj,   x_init,   y_init,   z_init = NULL,   covariates = NULL,   family = \"poisson\",   l2pen = 0.1,   library_multipler = rep(1, nrow(input_obj)),   max_iter = 100,   nuisance_vec = rep(NA, ncol(input_obj)),   offset_variables = NULL,   tol = 1e-06,   verbose = 0,   ... )"},{"path":"https://linnykos.github.io/eSVD2/reference/opt_esvd.default.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Optimize eSVD for matrices or sparse matrices. — opt_esvd.default","text":"input_obj Dataset (either matrix dgCMatrix) \\(n\\) rows represent cells \\(p\\) columns represent genes. rows columns matrix named. x_init Initial matrix cells' latent vectors \\(n\\) rows \\(k\\) columns. row names input_obj. y_init Initial matrix genes' latent vectors \\(p\\) rows \\(k\\) columns. row names column names input_obj. z_init Initial matrix genes' coefficient vectors \\(p\\) rows ncol(covariates) columns. row names column names input_obj, column names covariates. covariates matrix object \\(n\\) rows rownames input_obj columns represent different covariates. Notably, contain numerical columns (.e., categorical variables already split numerous indicator variables). family String among \"gaussian\", \"curved_gaussian\", \"exponential\", \"poisson\", \"neg_binom\", \"neg_binom2\", \"bernoulli\". Notably, exception \"neg_binom2\", families parameterized eSVD fitting dot product canonical parameter expoential-family distributions. \"neg_binom2\", dot product log-mean distribution (.e., similar canonical parameterization Poisson family). l2pen Small positive number amount penalization cells' genes' latent vectors well coefficients. library_multipler Vector positive numerics length \\(n\\). multiplier variance cell 's entries mean cell 's entries times square-root cell 's value library_multipler (entry-wise). used alternative interpretation library-size affects cell's gene expression (instead using library size covariate regressed ). max_iter Positive integer number iterations. nuisance_vec Vector non-negative numerics (NA's) length \\(p\\), representing gene's nuisance parameter using exponential-family distribution requires one. used family  \"curved_gaussian\" \"neg_binom\" \"neg_binom2\". offset_variables vector strings depicting column names input_obj$covariate treated offset optimization (.e., coefficients change throughout optimization). tol Small positive number differentiate zero non-zero. verbose Integer ... Additional parameters","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/opt_esvd.default.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Optimize eSVD for matrices or sparse matrices. — opt_esvd.default","text":"list elements x_mat, y_mat, z_mat, library_multiplier, loss, nuisance_vec param.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/opt_esvd.eSVD.html","id":null,"dir":"Reference","previous_headings":"","what":"Optimize eSVD for eSVD objects — opt_esvd.eSVD","title":"Optimize eSVD for eSVD objects — opt_esvd.eSVD","text":"Optimize eSVD eSVD objects","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/opt_esvd.eSVD.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Optimize eSVD for eSVD objects — opt_esvd.eSVD","text":"","code":"# S3 method for eSVD opt_esvd(   input_obj,   fit_name = \"fit_First\",   fit_previous = \"fit_Init\",   l2pen = 0.1,   max_iter = 100,   offset_variables = NULL,   tol = 1e-06,   verbose = 0,   ... )"},{"path":"https://linnykos.github.io/eSVD2/reference/opt_esvd.eSVD.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Optimize eSVD for eSVD objects — opt_esvd.eSVD","text":"input_obj eSVD object outputed apply_initial_threshold. fit_name String name become current fit storing results input_obj. fit_previous String name previous fit function grab initialization values . l2pen Small positive number amount penalization cells' genes' latent vectors well coefficients. max_iter Positive integer number iterations. offset_variables vector strings depicting column names input_obj$covariate treated offset optimization (.e., coefficients change throughout optimization). tol Small positive number differentiate zero non-zero. verbose Integer. ... Additional parameters.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/opt_esvd.eSVD.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Optimize eSVD for eSVD objects — opt_esvd.eSVD","text":"eSVD object added elements name whatever fit_name set .","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/opt_esvd.html","id":null,"dir":"Reference","previous_headings":"","what":"Optimize eSVD — opt_esvd","title":"Optimize eSVD — opt_esvd","text":"Generic function interface","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/opt_esvd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Optimize eSVD — opt_esvd","text":"","code":"opt_esvd(input_obj, ...)"},{"path":"https://linnykos.github.io/eSVD2/reference/opt_esvd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Optimize eSVD — opt_esvd","text":"input_obj Main object ... Additional parameters","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/opt_esvd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Optimize eSVD — opt_esvd","text":"Output dependent class input_obj","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/opt_x.html","id":null,"dir":"Reference","previous_headings":"","what":"Optimize X given C, Y and Z — opt_x","title":"Optimize X given C, Y and Z — opt_x","text":"Optimize X given C, Y Z","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/opt_x.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Optimize X given C, Y and Z — opt_x","text":"","code":"opt_x(   XC_init,   YZ,   k,   loader,   family,   s,   gamma,   l2penx,   verbose = 0,   inplace = FALSE,   ... )"},{"path":"https://linnykos.github.io/eSVD2/reference/opt_x.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Optimize X given C, Y and Z — opt_x","text":"XC_init Initial value `[X C]` matrix, X [n x k], C [n x r] YZ `[Y Z]` matrix, Y [p x k], Z [p x r] k Number columns X Y loader data loader, typically returned data_loader() family family object, typically returned esvd_family() s library size vector, [n x 1] gamma nuisance parameter vector, [p x 1] l2penx l2 penalty parameter X, scalar verbose Verbosity parameter inplace Whether input XC_init modified returned ... Additional parameters","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/opt_yz.html","id":null,"dir":"Reference","previous_headings":"","what":"Optimize Y and Z given X and C — opt_yz","title":"Optimize Y and Z given X and C — opt_yz","text":"Optimize Y Z given X C","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/opt_yz.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Optimize Y and Z given X and C — opt_yz","text":"","code":"opt_yz(   YZ_init,   XC,   k,   fixed_cols,   loader,   family,   s,   gamma,   l2peny,   l2penz,   verbose = 0,   inplace = FALSE,   ... )"},{"path":"https://linnykos.github.io/eSVD2/reference/opt_yz.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Optimize Y and Z given X and C — opt_yz","text":"YZ_init Initial value `[Y Z]` matrix, Y [p x k], Z [p x r] XC `[X C]` matrix, X [n x k], C [n x r] k Number columns X Y fixed_cols columns YZ need fixed loader data loader, typically returned data_loader() family family object, typically returned esvd_family() s library size vector, [n x 1] gamma nuisance parameter vector, [p x 1] l2peny l2 penalty parameter Y, scalar l2penz l2 penalty parameter Z, scalar verbose Verbosity parameter inplace Whether input XC_init modified returned ... Additional parameters","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/print.esvd_data_loader.html","id":null,"dir":"Reference","previous_headings":"","what":"Internal data loader function — print.esvd_data_loader","title":"Internal data loader function — print.esvd_data_loader","text":"Internal data loader function","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/print.esvd_data_loader.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Internal data loader function — print.esvd_data_loader","text":"","code":"# S3 method for esvd_data_loader print(x, ...)"},{"path":"https://linnykos.github.io/eSVD2/reference/print.esvd_data_loader.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Internal data loader function — print.esvd_data_loader","text":"x object ... additional arguments","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/print.esvd_data_loader.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Internal data loader function — print.esvd_data_loader","text":"description","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/reparameterization_esvd_covariates.html","id":null,"dir":"Reference","previous_headings":"","what":"Reparameterize eSVD object — reparameterization_esvd_covariates","title":"Reparameterize eSVD object — reparameterization_esvd_covariates","text":"Reparameterize eSVD object","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/reparameterization_esvd_covariates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Reparameterize eSVD object — reparameterization_esvd_covariates","text":"","code":"reparameterization_esvd_covariates(   input_obj,   fit_name,   omitted_variables = NULL,   verbose = 0 )"},{"path":"https://linnykos.github.io/eSVD2/reference/reparameterization_esvd_covariates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Reparameterize eSVD object — reparameterization_esvd_covariates","text":"input_obj eSVD object, either initialize_esvd() opt_esvd() fit_name name fit input_obj wish reparameterize. names(input_obj) omitted_variables Either NULL (default) variables input_obj$covariates reparameterized verbose Integer.","code":""},{"path":"https://linnykos.github.io/eSVD2/reference/reparameterization_esvd_covariates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Reparameterize eSVD object — reparameterization_esvd_covariates","text":"eSVD object adjusting fit fit_name.","code":""}]
