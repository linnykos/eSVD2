% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/compute_test_per_gene.R
\name{compute_test_per_gene}
\alias{compute_test_per_gene}
\title{Gene-wise posterior + test statistic + p-value without storing posterior matrices}
\usage{
compute_test_per_gene(
  input_obj,
  alpha_max = 1000,
  bool_adjust_covariates = FALSE,
  bool_covariates_as_library = TRUE,
  bool_stabilize_underdispersion = TRUE,
  library_min = 0.01,
  nuisance_lower_quantile = 0.01,
  pseudocount = 0,
  verbose = 0
)
}
\arguments{
\item{input_obj}{eSVD object after nuisance estimation.}

\item{alpha_max}{Maximum value of the prior mean (same role as in
\code{compute_posterior.eSVD}); default 1e3.}

\item{bool_adjust_covariates}{Boolean; if TRUE, adjust the prior by
confounding covariates (same as in
\code{compute_posterior.default}).}

\item{bool_covariates_as_library}{Boolean; if TRUE, include non–case-control
covariates in the covariate-adjusted library size.}

\item{bool_stabilize_underdispersion}{Boolean; if TRUE, mean-center
log10(nuisance_vec) when it suggests under-dispersion.}

\item{library_min}{Minimum value for the covariate-adjusted library size.}

\item{nuisance_lower_quantile}{Lower quantile at which to floor nuisance_vec.}

\item{pseudocount}{Numeric; additional count added to each entry in the
count matrix when forming the posterior.}

\item{verbose}{Integer; controls printed messages.}
}
\value{
The input \code{eSVD} object with:
  \itemize{
    \item \code{teststat_vec}  — Welch t-statistics (length p).
    \item \code{case_mean}    — case Gaussian means per gene.
    \item \code{control_mean} — control Gaussian means per gene.
    \item \code{pvalue_list}  — list with \code{df_vec}, \code{fdr_vec},
          \code{gaussian_teststat}, \code{log10pvalue},
          \code{null_mean}, \code{null_sd}.
  }
}
\description{
This function reproduces the behavior of
\code{compute_posterior()}, \code{compute_test_statistic()}, and
\code{compute_pvalue()}, but it computes everything one gene at a time
without ever allocating an n x p posterior mean/variance matrix.
}
